<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MapReduce | BIGDATA-TUTORIAL</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/bigdata-tutorial/favicon.ico">
    <meta name="description" content="å¤§æ•°æ®æ•™ç¨‹">
    
    <link rel="preload" href="/bigdata-tutorial/assets/css/0.styles.eecf7a64.css" as="style"><link rel="preload" href="/bigdata-tutorial/assets/js/app.3ada26ba.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/4.cda5e0f1.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/48.56d4fa14.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/5.9d6e4fe2.js" as="script"><link rel="prefetch" href="/bigdata-tutorial/assets/js/10.1ab7bd74.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/11.a42f7604.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/12.7dce2ed8.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/13.1b26207d.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/14.a9835374.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/15.90c66596.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/16.e0471453.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/17.2c0565cb.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/18.fabbce00.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/19.c120a108.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/20.5a4f48af.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/21.d3fce730.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/22.00ac574a.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/23.754595c9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/24.fc9d31a1.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/25.d4313bcb.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/26.604f045b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/27.22a239b2.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/28.466b9a71.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/29.2783ebfd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/30.2ff3250e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/31.2c64e404.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/32.0ab8b31c.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/33.be38d2dc.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/34.811f6626.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/35.9d9f3847.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/36.32bb3f84.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/37.db182f29.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/38.91a9d6f3.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/39.1148f971.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/40.1536c75c.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/41.31725066.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/42.68e59bdd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/43.9bac72d5.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/44.a2edd3e0.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/45.4a1cf2ae.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/46.d8a80a79.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/47.9621b1a5.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/49.d9d143dd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/50.6e4aa6cd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/51.55771fda.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/52.ee51188b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/53.b014e486.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/54.ae66c176.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/55.2ea9bfd9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/56.ffb4a04b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/57.bdee2f7e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/58.982c2219.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/59.c006237e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/6.3bb0b816.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/60.b27dc3c8.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/7.d55602d2.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/8.89e9ace9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/9.0c40eb95.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/vendors~flowchart.5998caa6.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/vendors~notification.943e54fe.js">
    <link rel="stylesheet" href="/bigdata-tutorial/assets/css/0.styles.eecf7a64.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bigdata-tutorial/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo-200.png" alt="BIGDATA-TUTORIAL" class="logo"> <span class="site-name can-hide">BIGDATA-TUTORIAL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bigdata-tutorial/hive/" class="nav-link">
  Hive
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hdfs/" class="nav-link">
  Hdfs
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hbase/" class="nav-link">
  Hbase
</a></div><div class="nav-item"><a href="/bigdata-tutorial/zookeeper/" class="nav-link">
  ZooKeeper
</a></div><div class="nav-item"><a href="/bigdata-tutorial/kafka/" class="nav-link">
  Kafka
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javatech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/bigdata-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/bigdata-tutorial/hive/" class="nav-link">
  Hive
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hdfs/" class="nav-link">
  Hdfs
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hbase/" class="nav-link">
  Hbase
</a></div><div class="nav-item"><a href="/bigdata-tutorial/zookeeper/" class="nav-link">
  ZooKeeper
</a></div><div class="nav-item"><a href="/bigdata-tutorial/kafka/" class="nav-link">
  Kafka
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javatech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/bigdata-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MapReduce</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata-tutorial/mapreduce/mapreduce.html#ä¸€ã€mapreduce-ç®€ä»‹" class="sidebar-link">ä¸€ã€MapReduce ç®€ä»‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#ç‰¹ç‚¹" class="sidebar-link">ç‰¹ç‚¹</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#åº”ç”¨åœºæ™¯" class="sidebar-link">åº”ç”¨åœºæ™¯</a></li></ul></li><li><a href="/bigdata-tutorial/mapreduce/mapreduce.html#äºŒã€mapreduce-ç¼–ç¨‹æ¨¡å‹" class="sidebar-link">äºŒã€MapReduce ç¼–ç¨‹æ¨¡å‹</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bigdata-tutorial/mapreduce/mapreduce.html#ä¸‰ã€combiner-partitioner" class="sidebar-link">ä¸‰ã€combiner &amp; partitioner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_3-1-inputformat-recordreaders" class="sidebar-link">3.1 InputFormat &amp; RecordReaders</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_3-2-combiner" class="sidebar-link">3.2 Combiner</a></li></ul></li><li><a href="/bigdata-tutorial/mapreduce/mapreduce.html#å››ã€mapreduceè¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹" class="sidebar-link">å››ã€MapReduceè¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_4-1-é¡¹ç›®ç®€ä»‹" class="sidebar-link">4.1 é¡¹ç›®ç®€ä»‹</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_4-2-é¡¹ç›®ä¾èµ–" class="sidebar-link">4.2 é¡¹ç›®ä¾èµ–</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_4-3-wordcountmapper" class="sidebar-link">4.3 WordCountMapper</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_4-4-wordcountreducer" class="sidebar-link">4.4 WordCountReducer</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_4-4-wordcountapp" class="sidebar-link">4.4 WordCountApp</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_4-5-æäº¤åˆ°æœåŠ¡å™¨è¿è¡Œ" class="sidebar-link">4.5 æäº¤åˆ°æœåŠ¡å™¨è¿è¡Œ</a></li></ul></li><li><a href="/bigdata-tutorial/mapreduce/mapreduce.html#äº”ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹combiner" class="sidebar-link">äº”ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹Combiner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_5-1-ä»£ç å®ç°" class="sidebar-link">5.1 ä»£ç å®ç°</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_5-2-æ‰§è¡Œç»“æœ" class="sidebar-link">5.2 æ‰§è¡Œç»“æœ</a></li></ul></li><li><a href="/bigdata-tutorial/mapreduce/mapreduce.html#å…­ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹partitioner" class="sidebar-link">å…­ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹Partitioner</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_6-1-é»˜è®¤çš„partitioner" class="sidebar-link">6.1 é»˜è®¤çš„Partitioner</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_6-2-è‡ªå®šä¹‰partitioner" class="sidebar-link">6.2 è‡ªå®šä¹‰Partitioner</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/mapreduce/mapreduce.html#_6-3-æ‰§è¡Œç»“æœ" class="sidebar-link">6.3 æ‰§è¡Œç»“æœ</a></li></ul></li><li><a href="/bigdata-tutorial/mapreduce/mapreduce.html#å‚è€ƒèµ„æ–™" class="sidebar-link">å‚è€ƒèµ„æ–™</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mapreduce"><a href="#mapreduce" class="header-anchor">#</a> MapReduce</h1> <h2 id="ä¸€ã€mapreduce-ç®€ä»‹"><a href="#ä¸€ã€mapreduce-ç®€ä»‹" class="header-anchor">#</a> ä¸€ã€MapReduce ç®€ä»‹</h2> <blockquote><p>Hadoop MapReduce æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ï¼Œç”¨äºç¼–å†™æ‰¹å¤„ç†åº”ç”¨ç¨‹åºã€‚ç¼–å†™å¥½çš„ç¨‹åºå¯ä»¥æäº¤åˆ° Hadoop é›†ç¾¤ä¸Šç”¨äºå¹¶è¡Œå¤„ç†å¤§è§„æ¨¡çš„æ•°æ®é›†ã€‚</p></blockquote> <p>MapReduce çš„è®¾è®¡æ€è·¯æ˜¯ï¼š</p> <ul><li>åˆ†è€Œæ²»ä¹‹ï¼Œå¹¶è¡Œè®¡ç®—</li> <li>ç§»åŠ¨è®¡ç®—ï¼Œè€Œéç§»åŠ¨æ•°æ®</li></ul> <p>MapReduce ä½œä¸šé€šè¿‡å°†è¾“å…¥çš„æ•°æ®é›†æ‹†åˆ†ä¸ºç‹¬ç«‹çš„å—ï¼Œè¿™äº›å—ç”± <code>map</code> ä»¥å¹¶è¡Œçš„æ–¹å¼å¤„ç†ï¼Œæ¡†æ¶å¯¹ <code>map</code> çš„è¾“å‡ºè¿›è¡Œæ’åºï¼Œç„¶åè¾“å…¥åˆ° <code>reduce</code> ä¸­ã€‚MapReduce æ¡†æ¶ä¸“é—¨ç”¨äº <code>&lt;keyï¼Œvalue&gt;</code> é”®å€¼å¯¹å¤„ç†ï¼Œå®ƒå°†ä½œä¸šçš„è¾“å…¥è§†ä¸ºä¸€ç»„ <code>&lt;keyï¼Œvalue&gt;</code> å¯¹ï¼Œå¹¶ç”Ÿæˆä¸€ç»„ <code>&lt;keyï¼Œvalue&gt;</code> å¯¹ä½œä¸ºè¾“å‡ºã€‚è¾“å‡ºå’Œè¾“å‡ºçš„ <code>key</code> å’Œ <code>value</code> éƒ½å¿…é¡»å®ç°<a href="http://hadoop.apache.org/docs/stable/api/org/apache/hadoop/io/Writable.html" target="_blank" rel="noopener noreferrer">Writable<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥å£ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>(input) &lt;k1, v1&gt; -&gt; map -&gt; &lt;k2, v2&gt; -&gt; combine -&gt; &lt;k2, v2&gt; -&gt; reduce -&gt; &lt;k3, v3&gt; (output)
</code></pre></div><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="header-anchor">#</a> ç‰¹ç‚¹</h3> <ul><li>è®¡ç®—è·Ÿç€æ•°æ®èµ°</li> <li>è‰¯å¥½çš„æ‰©å±•æ€§ï¼šè®¡ç®—èƒ½åŠ›éšç€èŠ‚ç‚¹æ•°å¢åŠ ï¼Œè¿‘ä¼¼çº¿æ€§é€’å¢</li> <li>é«˜å®¹é”™</li> <li>çŠ¶æ€ç›‘æ§</li> <li>é€‚åˆæµ·é‡æ•°æ®çš„ç¦»çº¿æ‰¹å¤„ç†</li> <li>é™ä½äº†åˆ†å¸ƒå¼ç¼–ç¨‹çš„é—¨æ§›</li></ul> <h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="header-anchor">#</a> åº”ç”¨åœºæ™¯</h3> <p>é€‚ç”¨åœºæ™¯ï¼š</p> <ul><li>æ•°æ®ç»Ÿè®¡ï¼Œå¦‚ï¼šç½‘ç«™çš„ PVã€UV ç»Ÿè®¡</li> <li>æœç´¢å¼•æ“æ„å»ºç´¢å¼•</li> <li>æµ·é‡æ•°æ®æŸ¥è¯¢</li></ul> <p>ä¸é€‚ç”¨åœºæ™¯ï¼š</p> <ul><li>OLAP
<ul><li>è¦æ±‚æ¯«ç§’æˆ–ç§’çº§è¿”å›ç»“æœ</li></ul></li> <li>æµè®¡ç®—
<ul><li>æµè®¡ç®—çš„è¾“å…¥æ•°æ®é›†æ˜¯åŠ¨æ€çš„ï¼Œè€Œ MapReduce æ˜¯é™æ€çš„</li></ul></li> <li>DAG è®¡ç®—
<ul><li>å¤šä¸ªä½œä¸šå­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåä¸€ä¸ªçš„è¾“å…¥æ˜¯å‰ä¸€ä¸ªçš„è¾“å‡ºï¼Œæ„æˆæœ‰å‘æ— ç¯å›¾ DAG</li> <li>æ¯ä¸ª MapReduce ä½œä¸šçš„è¾“å‡ºç»“æœéƒ½ä¼šè½ç›˜ï¼Œé€ æˆå¤§é‡ç£ç›˜ IOï¼Œå¯¼è‡´æ€§èƒ½éå¸¸ä½ä¸‹</li></ul></li></ul> <h2 id="äºŒã€mapreduce-ç¼–ç¨‹æ¨¡å‹"><a href="#äºŒã€mapreduce-ç¼–ç¨‹æ¨¡å‹" class="header-anchor">#</a> äºŒã€MapReduce ç¼–ç¨‹æ¨¡å‹</h2> <p>MapReduce ç¼–ç¨‹æ¨¡å‹ï¼šMapReduce ç¨‹åºè¢«åˆ†ä¸º Mapï¼ˆæ˜ å°„ï¼‰é˜¶æ®µå’Œ Reduceï¼ˆåŒ–ç®€ï¼‰é˜¶æ®µã€‚</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200601162305.png" alt="img"></p> <ol><li><strong>input</strong> : è¯»å–æ–‡æœ¬æ–‡ä»¶ï¼›</li> <li><strong>splitting</strong> : å°†æ–‡ä»¶æŒ‰ç…§è¡Œè¿›è¡Œæ‹†åˆ†ï¼Œæ­¤æ—¶å¾—åˆ°çš„ <code>K1</code> è¡Œæ•°ï¼Œ<code>V1</code> è¡¨ç¤ºå¯¹åº”è¡Œçš„æ–‡æœ¬å†…å®¹ï¼›</li> <li><strong>mapping</strong> : å¹¶è¡Œå°†æ¯ä¸€è¡ŒæŒ‰ç…§ç©ºæ ¼è¿›è¡Œæ‹†åˆ†ï¼Œæ‹†åˆ†å¾—åˆ°çš„ <code>List(K2,V2)</code>ï¼Œå…¶ä¸­ <code>K2</code> ä»£è¡¨æ¯ä¸€ä¸ªå•è¯ï¼Œç”±äºæ˜¯åšè¯é¢‘ç»Ÿè®¡ï¼Œæ‰€ä»¥ <code>V2</code> çš„å€¼ä¸º 1ï¼Œä»£è¡¨å‡ºç° 1 æ¬¡ï¼›</li> <li><strong>shuffling</strong>ï¼šç”±äº <code>Mapping</code> æ“ä½œå¯èƒ½æ˜¯åœ¨ä¸åŒçš„æœºå™¨ä¸Šå¹¶è¡Œå¤„ç†çš„ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ <code>shuffling</code> å°†ç›¸åŒ <code>key</code> å€¼çš„æ•°æ®åˆ†å‘åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šå»åˆå¹¶ï¼Œè¿™æ ·æ‰èƒ½ç»Ÿè®¡å‡ºæœ€ç»ˆçš„ç»“æœï¼Œæ­¤æ—¶å¾—åˆ° <code>K2</code> ä¸ºæ¯ä¸€ä¸ªå•è¯ï¼Œ<code>List(V2)</code> ä¸ºå¯è¿­ä»£é›†åˆï¼Œ<code>V2</code> å°±æ˜¯ Mapping ä¸­çš„ V2ï¼›</li> <li><strong>Reducing</strong> : è¿™é‡Œçš„æ¡ˆä¾‹æ˜¯ç»Ÿè®¡å•è¯å‡ºç°çš„æ€»æ¬¡æ•°ï¼Œæ‰€ä»¥ <code>Reducing</code> å¯¹ <code>List(V2)</code> è¿›è¡Œå½’çº¦æ±‚å’Œæ“ä½œï¼Œæœ€ç»ˆè¾“å‡ºã€‚</li></ol> <p>MapReduce ç¼–ç¨‹æ¨¡å‹ä¸­ <code>splitting</code> å’Œ <code>shuffing</code> æ“ä½œéƒ½æ˜¯ç”±æ¡†æ¶å®ç°çš„ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±ç¼–ç¨‹å®ç°çš„åªæœ‰ <code>mapping</code> å’Œ <code>reducing</code>ï¼Œè¿™ä¹Ÿå°±æ˜¯ MapReduce è¿™ä¸ªç§°å‘¼çš„æ¥æºã€‚</p> <h2 id="ä¸‰ã€combiner-partitioner"><a href="#ä¸‰ã€combiner-partitioner" class="header-anchor">#</a> ä¸‰ã€combiner &amp; partitioner</h2> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200601163846.png" alt="img"></p> <h3 id="_3-1-inputformat-recordreaders"><a href="#_3-1-inputformat-recordreaders" class="header-anchor">#</a> 3.1 InputFormat &amp; RecordReaders</h3> <p><code>InputFormat</code> å°†è¾“å‡ºæ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ª <code>InputSplit</code>ï¼Œå¹¶ç”± <code>RecordReaders</code> å°† <code>InputSplit</code> è½¬æ¢ä¸ºæ ‡å‡†çš„&lt;keyï¼Œvalue&gt;é”®å€¼å¯¹ï¼Œä½œä¸º map çš„è¾“å‡ºã€‚è¿™ä¸€æ­¥çš„æ„ä¹‰åœ¨äºåªæœ‰å…ˆè¿›è¡Œé€»è¾‘æ‹†åˆ†å¹¶è½¬ä¸ºæ ‡å‡†çš„é”®å€¼å¯¹æ ¼å¼åï¼Œæ‰èƒ½ä¸ºå¤šä¸ª <code>map</code> æä¾›è¾“å…¥ï¼Œä»¥ä¾¿è¿›è¡Œå¹¶è¡Œå¤„ç†ã€‚</p> <h3 id="_3-2-combiner"><a href="#_3-2-combiner" class="header-anchor">#</a> 3.2 Combiner</h3> <p><code>combiner</code> æ˜¯ <code>map</code> è¿ç®—åçš„å¯é€‰æ“ä½œï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªæœ¬åœ°åŒ–çš„ <code>reduce</code> æ“ä½œï¼Œå®ƒä¸»è¦æ˜¯åœ¨ <code>map</code> è®¡ç®—å‡ºä¸­é—´æ–‡ä»¶ååšä¸€ä¸ªç®€å•çš„åˆå¹¶é‡å¤ <code>key</code> å€¼çš„æ“ä½œã€‚è¿™é‡Œä»¥è¯é¢‘ç»Ÿè®¡ä¸ºä¾‹ï¼š</p> <p><code>map</code> åœ¨é‡åˆ°ä¸€ä¸ª hadoop çš„å•è¯æ—¶å°±ä¼šè®°å½•ä¸º 1ï¼Œä½†æ˜¯è¿™ç¯‡æ–‡ç« é‡Œ hadoop å¯èƒ½ä¼šå‡ºç° n å¤šæ¬¡ï¼Œé‚£ä¹ˆ <code>map</code> è¾“å‡ºæ–‡ä»¶å†—ä½™å°±ä¼šå¾ˆå¤šï¼Œå› æ­¤åœ¨ <code>reduce</code> è®¡ç®—å‰å¯¹ç›¸åŒçš„ key åšä¸€ä¸ªåˆå¹¶æ“ä½œï¼Œé‚£ä¹ˆéœ€è¦ä¼ è¾“çš„æ•°æ®é‡å°±ä¼šå‡å°‘ï¼Œä¼ è¾“æ•ˆç‡å°±å¯ä»¥å¾—åˆ°æå‡ã€‚</p> <p>ä½†å¹¶éæ‰€æœ‰åœºæ™¯éƒ½é€‚åˆä½¿ç”¨ <code>combiner</code>ï¼Œä½¿ç”¨å®ƒçš„åŸåˆ™æ˜¯ <code>combiner</code> çš„è¾“å‡ºä¸ä¼šå½±å“åˆ° <code>reduce</code> è®¡ç®—çš„æœ€ç»ˆè¾“å…¥ï¼Œä¾‹å¦‚ï¼šæ±‚æ€»æ•°ï¼Œæœ€å¤§å€¼ï¼Œæœ€å°å€¼æ—¶éƒ½å¯ä»¥ä½¿ç”¨ <code>combiner</code>ï¼Œä½†æ˜¯åšå¹³å‡å€¼è®¡ç®—åˆ™ä¸èƒ½ä½¿ç”¨ <code>combiner</code>ã€‚</p> <p>ä¸ä½¿ç”¨ combiner çš„æƒ…å†µï¼š</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200601164709.png" alt="img"></p> <p>ä½¿ç”¨ combiner çš„æƒ…å†µï¼š</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200601164804.png" alt="img"></p> <p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨ combiner çš„æ—¶å€™ï¼Œéœ€è¦ä¼ è¾“åˆ° reducer ä¸­çš„æ•°æ®ç”± 12keysï¼Œé™ä½åˆ° 10keysã€‚é™ä½çš„å¹…åº¦å–å†³äºä½  keys çš„é‡å¤ç‡ï¼Œä¸‹æ–‡è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹ä¼šæ¼”ç¤ºç”¨ combiner é™ä½æ•°ç™¾å€çš„ä¼ è¾“é‡ã€‚</p> <h2 id="å››ã€mapreduceè¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹"><a href="#å››ã€mapreduceè¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹" class="header-anchor">#</a> å››ã€MapReduceè¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹</h2> <h3 id="_4-1-é¡¹ç›®ç®€ä»‹"><a href="#_4-1-é¡¹ç›®ç®€ä»‹" class="header-anchor">#</a> 4.1 é¡¹ç›®ç®€ä»‹</h3> <p>è¿™é‡Œç»™å‡ºä¸€ä¸ªç»å…¸çš„è¯é¢‘ç»Ÿè®¡çš„æ¡ˆä¾‹ï¼šç»Ÿè®¡å¦‚ä¸‹æ ·æœ¬æ•°æ®ä¸­æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>Spark	HBase
Hive	Flink	Storm	Hadoop	HBase	Spark
Flink
HBase	Storm
HBase	Hadoop	Hive	Flink
HBase	Flink	Hive	Storm
Hive	Flink	Hadoop
HBase	Hive
Hadoop	Spark	HBase	Storm
HBase	Hadoop	Hive	Flink
HBase	Flink	Hive	Storm
Hive	Flink	Hadoop
HBase	Hive
</code></pre></div><p>ä¸ºæ–¹ä¾¿å¤§å®¶å¼€å‘ï¼Œæˆ‘åœ¨é¡¹ç›®æºç ä¸­æ”¾ç½®äº†ä¸€ä¸ªå·¥å…·ç±» <code>WordCountDataUtils</code>ï¼Œç”¨äºæ¨¡æ‹Ÿäº§ç”Ÿè¯é¢‘ç»Ÿè®¡çš„æ ·æœ¬ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ”¯æŒè¾“å‡ºåˆ°æœ¬åœ°æˆ–è€…ç›´æ¥å†™åˆ° HDFS ä¸Šã€‚</p> <blockquote><p>é¡¹ç›®å®Œæ•´æºç ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/heibaiying/BigData-Notes/tree/master/code/Hadoop/hadoop-word-count" target="_blank" rel="noopener noreferrer">hadoop-word-count<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="_4-2-é¡¹ç›®ä¾èµ–"><a href="#_4-2-é¡¹ç›®ä¾èµ–" class="header-anchor">#</a> 4.2 é¡¹ç›®ä¾èµ–</h3> <p>æƒ³è¦è¿›è¡Œ MapReduce ç¼–ç¨‹ï¼Œéœ€è¦å¯¼å…¥ <code>hadoop-client</code> ä¾èµ–ï¼š</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.hadoop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hadoop-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${hadoop.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_4-3-wordcountmapper"><a href="#_4-3-wordcountmapper" class="header-anchor">#</a> 4.3 WordCountMapper</h3> <p>å°†æ¯è¡Œæ•°æ®æŒ‰ç…§æŒ‡å®šåˆ†éš”ç¬¦è¿›è¡Œæ‹†åˆ†ã€‚è¿™é‡Œéœ€è¦æ³¨æ„åœ¨ MapReduce ä¸­å¿…é¡»ä½¿ç”¨ Hadoop å®šä¹‰çš„ç±»å‹ï¼Œå› ä¸º Hadoop é¢„å®šä¹‰çš„ç±»å‹éƒ½æ˜¯å¯åºåˆ—åŒ–ï¼Œå¯æ¯”è¾ƒçš„ï¼Œæ‰€æœ‰ç±»å‹å‡å®ç°äº† <code>WritableComparable</code> æ¥å£ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordCountMapper</span> <span class="token keyword">extends</span> <span class="token class-name">Mapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LongWritable</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">IntWritable</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">LongWritable</span> key<span class="token punctuation">,</span> <span class="token class-name">Text</span> value<span class="token punctuation">,</span> <span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> 
                                                                      <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> words <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;\t&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> word <span class="token operator">:</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            context<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IntWritable</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p><code>WordCountMapper</code> å¯¹åº”ä¸‹å›¾çš„ Mapping æ“ä½œï¼š</p> <p><a href="https://camo.githubusercontent.com/fcf3ac016579c1fbb050d97309660aaa3b9550cc/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d636f64652d6d617070696e672e706e67" target="_blank" rel="noopener noreferrer"><img src="https://camo.githubusercontent.com/fcf3ac016579c1fbb050d97309660aaa3b9550cc/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d636f64652d6d617070696e672e706e67" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>WordCountMapper</code> ç»§æ‰¿è‡ª <code>Mappe</code> ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªæ³›å‹ç±»ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">WordCountMapper</span> <span class="token keyword">extends</span> <span class="token class-name">Mapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">LongWritable</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">IntWritable</span><span class="token punctuation">&gt;</span></span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Mapper</span><span class="token generics"><span class="token punctuation">&lt;</span>KEYIN<span class="token punctuation">,</span> VALUEIN<span class="token punctuation">,</span> KEYOUT<span class="token punctuation">,</span> VALUEOUT<span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>KEYIN</strong> : <code>mapping</code> è¾“å…¥ key çš„ç±»å‹ï¼Œå³æ¯è¡Œçš„åç§»é‡ (æ¯è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦åœ¨æ•´ä¸ªæ–‡æœ¬ä¸­çš„ä½ç½®)ï¼Œ<code>Long</code> ç±»å‹ï¼Œå¯¹åº” Hadoop ä¸­çš„ <code>LongWritable</code> ç±»å‹ï¼›</li> <li><strong>VALUEIN</strong> : <code>mapping</code> è¾“å…¥ value çš„ç±»å‹ï¼Œå³æ¯è¡Œæ•°æ®ï¼›<code>String</code> ç±»å‹ï¼Œå¯¹åº” Hadoop ä¸­ <code>Text</code> ç±»å‹ï¼›</li> <li><strong>KEYOUT</strong> ï¼š<code>mapping</code> è¾“å‡ºçš„ key çš„ç±»å‹ï¼Œå³æ¯ä¸ªå•è¯ï¼›<code>String</code> ç±»å‹ï¼Œå¯¹åº” Hadoop ä¸­ <code>Text</code> ç±»å‹ï¼›</li> <li><strong>VALUEOUT</strong>ï¼š<code>mapping</code> è¾“å‡º value çš„ç±»å‹ï¼Œå³æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°ï¼›è¿™é‡Œç”¨ <code>int</code> ç±»å‹ï¼Œå¯¹åº” <code>IntWritable</code> ç±»å‹ã€‚</li></ul> <h3 id="_4-4-wordcountreducer"><a href="#_4-4-wordcountreducer" class="header-anchor">#</a> 4.4 WordCountReducer</h3> <p>åœ¨ Reduce ä¸­è¿›è¡Œå•è¯å‡ºç°æ¬¡æ•°çš„ç»Ÿè®¡ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordCountReducer</span> <span class="token keyword">extends</span> <span class="token class-name">Reducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">IntWritable</span><span class="token punctuation">,</span> <span class="token class-name">Text</span><span class="token punctuation">,</span> <span class="token class-name">IntWritable</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">reduce</span><span class="token punctuation">(</span><span class="token class-name">Text</span> key<span class="token punctuation">,</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">IntWritable</span><span class="token punctuation">&gt;</span></span> values<span class="token punctuation">,</span> <span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> 
                                                                                  <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">IntWritable</span> value <span class="token operator">:</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            count <span class="token operator">+=</span> value<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        context<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IntWritable</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦‚ä¸‹å›¾ï¼Œ<code>shuffling</code> çš„è¾“å‡ºæ˜¯ reduce çš„è¾“å…¥ã€‚è¿™é‡Œçš„ key æ˜¯æ¯ä¸ªå•è¯ï¼Œvalues æ˜¯ä¸€ä¸ªå¯è¿­ä»£çš„æ•°æ®ç±»å‹ï¼Œç±»ä¼¼ <code>(1,1,1,...)</code>ã€‚</p> <p><a href="https://camo.githubusercontent.com/bf6ad9c970812b1db6f6f86d12d783db75eaa9fb/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d636f64652d726564756365722e706e67" target="_blank" rel="noopener noreferrer"><img src="https://camo.githubusercontent.com/bf6ad9c970812b1db6f6f86d12d783db75eaa9fb/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d636f64652d726564756365722e706e67" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_4-4-wordcountapp"><a href="#_4-4-wordcountapp" class="header-anchor">#</a> 4.4 WordCountApp</h3> <p>ç»„è£… MapReduce ä½œä¸šï¼Œå¹¶æäº¤åˆ°æœåŠ¡å™¨è¿è¡Œï¼Œä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
 * ç»„è£…ä½œä¸š å¹¶æäº¤åˆ°é›†ç¾¤è¿è¡Œ
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordCountApp</span> <span class="token punctuation">{</span>


    <span class="token comment">// è¿™é‡Œä¸ºäº†ç›´è§‚æ˜¾ç¤ºå‚æ•° ä½¿ç”¨äº†ç¡¬ç¼–ç ï¼Œå®é™…å¼€å‘ä¸­å¯ä»¥é€šè¿‡å¤–éƒ¨ä¼ å‚</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> HDFS_URL <span class="token operator">=</span> <span class="token string">&quot;hdfs://192.168.0.107:8020&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> HADOOP_USER_NAME <span class="token operator">=</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

        <span class="token comment">//  æ–‡ä»¶è¾“å…¥è·¯å¾„å’Œè¾“å‡ºè·¯å¾„ç”±å¤–éƒ¨ä¼ å‚æŒ‡å®š</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Input and output paths are necessary!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// éœ€è¦æŒ‡æ˜ hadoop ç”¨æˆ·åï¼Œå¦åˆ™åœ¨ HDFS ä¸Šåˆ›å»ºç›®å½•æ—¶å¯èƒ½ä¼šæŠ›å‡ºæƒé™ä¸è¶³çš„å¼‚å¸¸</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">&quot;HADOOP_USER_NAME&quot;</span><span class="token punctuation">,</span> HADOOP_USER_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŒ‡æ˜ HDFS çš„åœ°å€</span>
        configuration<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;fs.defaultFS&quot;</span><span class="token punctuation">,</span> HDFS_URL<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆ›å»ºä¸€ä¸ª Job</span>
        <span class="token class-name">Job</span> job <span class="token operator">=</span> <span class="token class-name">Job</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½®è¿è¡Œçš„ä¸»ç±»</span>
        job<span class="token punctuation">.</span><span class="token function">setJarByClass</span><span class="token punctuation">(</span><span class="token class-name">WordCountApp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½® Mapper å’Œ Reducer</span>
        job<span class="token punctuation">.</span><span class="token function">setMapperClass</span><span class="token punctuation">(</span><span class="token class-name">WordCountMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setReducerClass</span><span class="token punctuation">(</span><span class="token class-name">WordCountReducer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½® Mapper è¾“å‡º key å’Œ value çš„ç±»å‹</span>
        job<span class="token punctuation">.</span><span class="token function">setMapOutputKeyClass</span><span class="token punctuation">(</span><span class="token class-name">Text</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setMapOutputValueClass</span><span class="token punctuation">(</span><span class="token class-name">IntWritable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¾ç½® Reducer è¾“å‡º key å’Œ value çš„ç±»å‹</span>
        job<span class="token punctuation">.</span><span class="token function">setOutputKeyClass</span><span class="token punctuation">(</span><span class="token class-name">Text</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setOutputValueClass</span><span class="token punctuation">(</span><span class="token class-name">IntWritable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¦‚æœè¾“å‡ºç›®å½•å·²ç»å­˜åœ¨ï¼Œåˆ™å¿…é¡»å…ˆåˆ é™¤ï¼Œå¦åˆ™é‡å¤è¿è¡Œç¨‹åºæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸</span>
        <span class="token class-name">FileSystem</span> fileSystem <span class="token operator">=</span> <span class="token class-name">FileSystem</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">URI</span><span class="token punctuation">(</span>HDFS_URL<span class="token punctuation">)</span><span class="token punctuation">,</span> configuration<span class="token punctuation">,</span> HADOOP_USER_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Path</span> outputPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>fileSystem<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>outputPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            fileSystem<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>outputPath<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è®¾ç½®ä½œä¸šè¾“å…¥æ–‡ä»¶å’Œè¾“å‡ºæ–‡ä»¶çš„è·¯å¾„</span>
        <span class="token class-name">FileInputFormat</span><span class="token punctuation">.</span><span class="token function">setInputPaths</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputFormat</span><span class="token punctuation">.</span><span class="token function">setOutputPath</span><span class="token punctuation">(</span>job<span class="token punctuation">,</span> outputPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å°†ä½œä¸šæäº¤åˆ°ç¾¤é›†å¹¶ç­‰å¾…å®ƒå®Œæˆï¼Œå‚æ•°è®¾ç½®ä¸º true ä»£è¡¨æ‰“å°æ˜¾ç¤ºå¯¹åº”çš„è¿›åº¦</span>
        <span class="token keyword">boolean</span> result <span class="token operator">=</span> job<span class="token punctuation">.</span><span class="token function">waitForCompletion</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å…³é—­ä¹‹å‰åˆ›å»ºçš„ fileSystem</span>
        fileSystem<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ ¹æ®ä½œä¸šç»“æœ,ç»ˆæ­¢å½“å‰è¿è¡Œçš„ Java è™šæ‹Ÿæœº,é€€å‡ºç¨‹åº</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span>result <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä¸è®¾ç½® <code>Mapper</code> æ“ä½œçš„è¾“å‡ºç±»å‹ï¼Œåˆ™ç¨‹åºé»˜è®¤å®ƒå’Œ <code>Reducer</code> æ“ä½œè¾“å‡ºçš„ç±»å‹ç›¸åŒã€‚</p> <h3 id="_4-5-æäº¤åˆ°æœåŠ¡å™¨è¿è¡Œ"><a href="#_4-5-æäº¤åˆ°æœåŠ¡å™¨è¿è¡Œ" class="header-anchor">#</a> 4.5 æäº¤åˆ°æœåŠ¡å™¨è¿è¡Œ</h3> <p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯ä»¥åœ¨æœ¬æœºé…ç½® hadoop å¼€å‘ç¯å¢ƒï¼Œç›´æ¥åœ¨ IDE ä¸­å¯åŠ¨è¿›è¡Œæµ‹è¯•ã€‚è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹æ‰“åŒ…æäº¤åˆ°æœåŠ¡å™¨è¿è¡Œã€‚ç”±äºæœ¬é¡¹ç›®æ²¡æœ‰ä½¿ç”¨é™¤ Hadoop å¤–çš„ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œç›´æ¥æ‰“åŒ…å³å¯ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># mvn clean package
</code></pre></div><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æäº¤ä½œä¸šï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>hadoop jar /usr/appjar/hadoop-word-count-1.0.jar \
com.heibaiying.WordCountApp \
/wordcount/input.txt /wordcount/output/WordCountApp
</code></pre></div><p>ä½œä¸šå®ŒæˆåæŸ¥çœ‹ HDFS ä¸Šç”Ÿæˆç›®å½•ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># æŸ¥çœ‹ç›®å½•
hadoop fs -ls /wordcount/output/WordCountApp

# æŸ¥çœ‹ç»Ÿè®¡ç»“æœ
hadoop fs -cat /wordcount/output/WordCountApp/part-r-00000
</code></pre></div><p><a href="https://camo.githubusercontent.com/cecb00eef3b951794fbf92b8308d8b6601faf5a0/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d776f7264636f756e746170702e706e67" target="_blank" rel="noopener noreferrer"><img src="https://camo.githubusercontent.com/cecb00eef3b951794fbf92b8308d8b6601faf5a0/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d776f7264636f756e746170702e706e67" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="äº”ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹combiner"><a href="#äº”ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹combiner" class="header-anchor">#</a> äº”ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹Combiner</h2> <h3 id="_5-1-ä»£ç å®ç°"><a href="#_5-1-ä»£ç å®ç°" class="header-anchor">#</a> 5.1 ä»£ç å®ç°</h3> <p>æƒ³è¦ä½¿ç”¨ <code>combiner</code> åŠŸèƒ½åªè¦åœ¨ç»„è£…ä½œä¸šæ—¶ï¼Œæ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç å³å¯ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// è®¾ç½® Combiner
job.setCombinerClass(WordCountReducer.class);
</code></pre></div><h3 id="_5-2-æ‰§è¡Œç»“æœ"><a href="#_5-2-æ‰§è¡Œç»“æœ" class="header-anchor">#</a> 5.2 æ‰§è¡Œç»“æœ</h3> <p>åŠ å…¥ <code>combiner</code> åç»Ÿè®¡ç»“æœæ˜¯ä¸ä¼šæœ‰å˜åŒ–çš„ï¼Œä½†æ˜¯å¯ä»¥ä»æ‰“å°çš„æ—¥å¿—çœ‹å‡º <code>combiner</code> çš„æ•ˆæœï¼š</p> <p>æ²¡æœ‰åŠ å…¥ <code>combiner</code> çš„æ‰“å°æ—¥å¿—ï¼š</p> <p><a href="https://camo.githubusercontent.com/e4849556db34d3a02b82b546af7296154920dfff/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d6e6f2d636f6d62696e65722e706e67" target="_blank" rel="noopener noreferrer"><img src="https://camo.githubusercontent.com/e4849556db34d3a02b82b546af7296154920dfff/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d6e6f2d636f6d62696e65722e706e67" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>åŠ å…¥ <code>combiner</code> åçš„æ‰“å°æ—¥å¿—å¦‚ä¸‹ï¼š</p> <p><a href="https://camo.githubusercontent.com/17f20f481bc4bd01252bc3ccb3b2aceb7d0eca63/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d636f6d62696e65722e706e67" target="_blank" rel="noopener noreferrer"><img src="https://camo.githubusercontent.com/17f20f481bc4bd01252bc3ccb3b2aceb7d0eca63/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d636f6d62696e65722e706e67" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>è¿™é‡Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªè¾“å…¥æ–‡ä»¶å¹¶ä¸”å°äº 128Mï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ª Map è¿›è¡Œå¤„ç†ã€‚å¯ä»¥çœ‹åˆ°ç»è¿‡ combiner åï¼Œrecords ç”± <code>3519</code> é™ä½ä¸º <code>6</code>(æ ·æœ¬ä¸­å•è¯ç§ç±»å°±åªæœ‰ 6 ç§)ï¼Œåœ¨è¿™ä¸ªç”¨ä¾‹ä¸­ combiner å°±èƒ½æå¤§åœ°é™ä½éœ€è¦ä¼ è¾“çš„æ•°æ®é‡ã€‚</p> <h2 id="å…­ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹partitioner"><a href="#å…­ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹partitioner" class="header-anchor">#</a> å…­ã€è¯é¢‘ç»Ÿè®¡æ¡ˆä¾‹è¿›é˜¶ä¹‹Partitioner</h2> <h3 id="_6-1-é»˜è®¤çš„partitioner"><a href="#_6-1-é»˜è®¤çš„partitioner" class="header-anchor">#</a> 6.1 é»˜è®¤çš„Partitioner</h3> <p>è¿™é‡Œå‡è®¾æœ‰ä¸ªéœ€æ±‚ï¼šå°†ä¸åŒå•è¯çš„ç»Ÿè®¡ç»“æœè¾“å‡ºåˆ°ä¸åŒæ–‡ä»¶ã€‚è¿™ç§éœ€æ±‚å®é™…ä¸Šæ¯”è¾ƒå¸¸è§ï¼Œæ¯”å¦‚ç»Ÿè®¡äº§å“çš„é”€é‡æ—¶ï¼Œéœ€è¦å°†ç»“æœæŒ‰ç…§äº§å“ç§ç±»è¿›è¡Œæ‹†åˆ†ã€‚è¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå°±éœ€è¦ç”¨åˆ°è‡ªå®šä¹‰ <code>Partitioner</code>ã€‚</p> <p>è¿™é‡Œå…ˆä»‹ç»ä¸‹ MapReduce é»˜è®¤çš„åˆ†ç±»è§„åˆ™ï¼šåœ¨æ„å»º job æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤çš„ä½¿ç”¨çš„æ˜¯ <code>HashPartitioner</code>ï¼šå¯¹ key å€¼è¿›è¡Œå“ˆå¸Œæ•£åˆ—å¹¶å¯¹ <code>numReduceTasks</code> å–ä½™ã€‚å…¶å®ç°å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>public class HashPartitioner&lt;K, V&gt; extends Partitioner&lt;K, V&gt; {

  public int getPartition(K key, V value,
                          int numReduceTasks) {
    return (key.hashCode() &amp; Integer.MAX_VALUE) % numReduceTasks;
  }

}
</code></pre></div><h3 id="_6-2-è‡ªå®šä¹‰partitioner"><a href="#_6-2-è‡ªå®šä¹‰partitioner" class="header-anchor">#</a> 6.2 è‡ªå®šä¹‰Partitioner</h3> <p>è¿™é‡Œæˆ‘ä»¬ç»§æ‰¿ <code>Partitioner</code> è‡ªå®šä¹‰åˆ†ç±»è§„åˆ™ï¼Œè¿™é‡ŒæŒ‰ç…§å•è¯è¿›è¡Œåˆ†ç±»ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>public class CustomPartitioner extends Partitioner&lt;Text, IntWritable&gt; {

    public int getPartition(Text text, IntWritable intWritable, int numPartitions) {
        return WordCountDataUtils.WORD_LIST.indexOf(text.toString());
    }
}
</code></pre></div><p>åœ¨æ„å»º <code>job</code> æ—¶å€™æŒ‡å®šä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„åˆ†ç±»è§„åˆ™ï¼Œå¹¶è®¾ç½® <code>reduce</code> çš„ä¸ªæ•°ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>// è®¾ç½®è‡ªå®šä¹‰åˆ†åŒºè§„åˆ™
job.setPartitionerClass(CustomPartitioner.class);
// è®¾ç½® reduce ä¸ªæ•°
job.setNumReduceTasks(WordCountDataUtils.WORD_LIST.size());
</code></pre></div><h3 id="_6-3-æ‰§è¡Œç»“æœ"><a href="#_6-3-æ‰§è¡Œç»“æœ" class="header-anchor">#</a> 6.3 æ‰§è¡Œç»“æœ</h3> <p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œåˆ†åˆ«ç”Ÿæˆ 6 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶ä¸­ä¸ºå¯¹åº”å•è¯çš„ç»Ÿè®¡ç»“æœï¼š</p> <p><a href="https://camo.githubusercontent.com/202b1eb7065e18a513db5b2a50b22ab62a7d6692/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d776f7264636f756e74636f6d62696e6572706172746974696f6e2e706e67" target="_blank" rel="noopener noreferrer"><img src="https://camo.githubusercontent.com/202b1eb7065e18a513db5b2a50b22ab62a7d6692/68747470733a2f2f67697465652e636f6d2f68656962616979696e672f426967446174612d4e6f7465732f7261772f6d61737465722f70696374757265732f6861646f6f702d776f7264636f756e74636f6d62696e6572706172746974696f6e2e706e67" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="header-anchor">#</a> å‚è€ƒèµ„æ–™</h2> <ul><li><a href="https://github.com/heibaiying/BigData-Notes/blob/master/notes/Hadoop-MapReduce.md" target="_blank" rel="noopener noreferrer">åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶â€”â€”MapReduce<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/bigdata-tutorial/edit/master/docs/mapreduce/mapreduce.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æˆ‘ä»¬æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">9 months ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/bigdata-tutorial/assets/js/app.3ada26ba.js" defer></script><script src="/bigdata-tutorial/assets/js/4.cda5e0f1.js" defer></script><script src="/bigdata-tutorial/assets/js/48.56d4fa14.js" defer></script><script src="/bigdata-tutorial/assets/js/5.9d6e4fe2.js" defer></script>
  </body>
</html>
