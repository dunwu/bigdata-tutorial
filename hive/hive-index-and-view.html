<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hive 视图和索引 | BIGDATA-TUTORIAL</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/bigdata-tutorial/favicon.ico">
    <meta name="description" content="大数据教程">
    
    <link rel="preload" href="/bigdata-tutorial/assets/css/0.styles.eecf7a64.css" as="style"><link rel="preload" href="/bigdata-tutorial/assets/js/app.3ada26ba.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/4.cda5e0f1.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/34.811f6626.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/5.9d6e4fe2.js" as="script"><link rel="prefetch" href="/bigdata-tutorial/assets/js/10.1ab7bd74.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/11.a42f7604.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/12.7dce2ed8.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/13.1b26207d.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/14.a9835374.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/15.90c66596.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/16.e0471453.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/17.2c0565cb.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/18.fabbce00.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/19.c120a108.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/20.5a4f48af.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/21.d3fce730.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/22.00ac574a.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/23.754595c9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/24.fc9d31a1.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/25.d4313bcb.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/26.604f045b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/27.22a239b2.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/28.466b9a71.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/29.2783ebfd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/30.2ff3250e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/31.2c64e404.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/32.0ab8b31c.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/33.be38d2dc.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/35.9d9f3847.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/36.32bb3f84.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/37.db182f29.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/38.91a9d6f3.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/39.1148f971.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/40.1536c75c.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/41.31725066.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/42.68e59bdd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/43.9bac72d5.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/44.a2edd3e0.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/45.4a1cf2ae.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/46.d8a80a79.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/47.9621b1a5.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/48.56d4fa14.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/49.d9d143dd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/50.6e4aa6cd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/51.55771fda.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/52.ee51188b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/53.b014e486.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/54.ae66c176.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/55.2ea9bfd9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/56.ffb4a04b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/57.bdee2f7e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/58.982c2219.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/59.c006237e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/6.3bb0b816.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/60.b27dc3c8.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/7.d55602d2.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/8.89e9ace9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/9.0c40eb95.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/vendors~flowchart.5998caa6.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/vendors~notification.943e54fe.js">
    <link rel="stylesheet" href="/bigdata-tutorial/assets/css/0.styles.eecf7a64.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bigdata-tutorial/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo-200.png" alt="BIGDATA-TUTORIAL" class="logo"> <span class="site-name can-hide">BIGDATA-TUTORIAL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bigdata-tutorial/hive/" class="nav-link router-link-active">
  Hive
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hdfs/" class="nav-link">
  Hdfs
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hbase/" class="nav-link">
  Hbase
</a></div><div class="nav-item"><a href="/bigdata-tutorial/zookeeper/" class="nav-link">
  ZooKeeper
</a></div><div class="nav-item"><a href="/bigdata-tutorial/kafka/" class="nav-link">
  Kafka
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">✨ Java系列</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">✨ Java系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javatech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🎯 博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/bigdata-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/bigdata-tutorial/hive/" class="nav-link router-link-active">
  Hive
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hdfs/" class="nav-link">
  Hdfs
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hbase/" class="nav-link">
  Hbase
</a></div><div class="nav-item"><a href="/bigdata-tutorial/zookeeper/" class="nav-link">
  ZooKeeper
</a></div><div class="nav-item"><a href="/bigdata-tutorial/kafka/" class="nav-link">
  Kafka
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">✨ Java系列</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">✨ Java系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javatech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot 教程 📚
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🎯 博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/bigdata-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Hive 视图和索引</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata-tutorial/hive/hive-index-and-view.html#一、视图" class="sidebar-link">一、视图</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#创建视图" class="sidebar-link">创建视图</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#查看视图" class="sidebar-link">查看视图</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#删除视图" class="sidebar-link">删除视图</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#修改视图" class="sidebar-link">修改视图</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#修改视图属性" class="sidebar-link">修改视图属性</a></li></ul></li><li><a href="/bigdata-tutorial/hive/hive-index-and-view.html#二、索引" class="sidebar-link">二、索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#简介-2" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#索引原理" class="sidebar-link">索引原理</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#创建索引" class="sidebar-link">创建索引</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#查看索引" class="sidebar-link">查看索引</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#删除索引" class="sidebar-link">删除索引</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#重建索引" class="sidebar-link">重建索引</a></li></ul></li><li><a href="/bigdata-tutorial/hive/hive-index-and-view.html#三、索引案例" class="sidebar-link">三、索引案例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#创建索引-2" class="sidebar-link">创建索引</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#重建索引-2" class="sidebar-link">重建索引</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#自动使用索引" class="sidebar-link">自动使用索引</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/hive/hive-index-and-view.html#查看索引-2" class="sidebar-link">查看索引</a></li></ul></li><li><a href="/bigdata-tutorial/hive/hive-index-and-view.html#四、索引的缺陷" class="sidebar-link">四、索引的缺陷</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bigdata-tutorial/hive/hive-index-and-view.html#参考资料" class="sidebar-link">参考资料</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hive-视图和索引"><a href="#hive-视图和索引" class="header-anchor">#</a> Hive 视图和索引</h1> <h2 id="一、视图"><a href="#一、视图" class="header-anchor">#</a> 一、视图</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>Hive 中的视图和 RDBMS 中视图的概念一致，都是一组数据的逻辑表示，本质上就是一条 SELECT 语句的结果集。视图是纯粹的逻辑对象，没有关联的存储 (Hive 3.0.0 引入的物化视图除外)，当查询引用视图时，Hive 可以将视图的定义与查询结合起来，例如将查询中的过滤器推送到视图中。</p> <h3 id="创建视图"><a href="#创建视图" class="header-anchor">#</a> 创建视图</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>db_name<span class="token punctuation">.</span><span class="token punctuation">]</span>view_name   <span class="token comment">-- 视图名称</span>
  <span class="token punctuation">[</span><span class="token punctuation">(</span>column_name <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> column_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">]</span>    <span class="token comment">--列名</span>
  <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> view_comment<span class="token punctuation">]</span>  <span class="token comment">--视图注释</span>
  <span class="token punctuation">[</span>TBLPROPERTIES <span class="token punctuation">(</span>property_name <span class="token operator">=</span> property_value<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment">--额外信息</span>
  <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre></div><p>在 Hive 中可以使用 <code>CREATE VIEW</code> 创建视图，如果已存在具有相同名称的表或视图，则会抛出异常，建议使用 <code>IF NOT EXISTS</code> 预做判断。在使用视图时候需要注意以下事项：</p> <ul><li><p>视图是只读的，不能用作 <code>LOAD</code> / <code>INSERT</code> / <code>ALTER</code> 的目标；</p></li> <li><p>在创建视图时候视图就已经固定，对基表的后续更改（如添加列）将不会反映在视图；</p></li> <li><p>删除基表并不会删除视图，需要手动删除视图；</p></li> <li><p>视图可能包含 <code>ORDER BY</code> 和 <code>LIMIT</code> 子句。如果引用视图的查询语句也包含这类子句，其执行优先级低于视图对应字句。例如，视图 <code>custom_view</code> 指定 LIMIT 5，查询语句为 <code>select * from custom_view LIMIT 10</code>，此时结果最多返回 5 行。</p></li> <li><p>创建视图时，如果未提供列名，则将从 SELECT 语句中自动派生列名；</p></li> <li><p>创建视图时，如果 SELECT 语句中包含其他表达式，例如 x + y，则列名称将以_C0，_C1 等形式生成；</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span>  <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> custom_view <span class="token keyword">AS</span> <span class="token keyword">SELECT</span> empno<span class="token punctuation">,</span> empno<span class="token operator">+</span>deptno <span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span> <span class="token keyword">FROM</span> emp<span class="token punctuation">;</span>
</code></pre></div></li></ul> <p><img src="https://github.com/heibaiying/BigData-Notes/raw/master/pictures/hive-1-2-view.png" alt="img"></p> <h3 id="查看视图"><a href="#查看视图" class="header-anchor">#</a> 查看视图</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查看所有视图： 没有单独查看视图列表的语句，只能使用 show tables</span>
<span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>
<span class="token comment">-- 查看某个视图</span>
<span class="token keyword">desc</span> view_name<span class="token punctuation">;</span>
<span class="token comment">-- 查看某个视图详细信息</span>
<span class="token keyword">desc</span> formatted view_name<span class="token punctuation">;</span>
</code></pre></div><h3 id="删除视图"><a href="#删除视图" class="header-anchor">#</a> 删除视图</h3> <div class="language- extra-class"><pre class="language-text"><code>DROP VIEW [IF EXISTS] [db_name.]view_name;
</code></pre></div><p>删除视图时，如果被删除的视图被其他视图所引用，这时候程序不会发出警告，但是引用该视图其他视图已经失效，需要进行重建或者删除。</p> <h3 id="修改视图"><a href="#修改视图" class="header-anchor">#</a> 修改视图</h3> <div class="language- extra-class"><pre class="language-text"><code>ALTER VIEW [db_name.]view_name AS select_statement;
</code></pre></div><p>被更改的视图必须存在，且视图不能具有分区，如果视图具有分区，则修改失败。</p> <h3 id="修改视图属性"><a href="#修改视图属性" class="header-anchor">#</a> 修改视图属性</h3> <p>语法：</p> <div class="language- extra-class"><pre class="language-text"><code>ALTER VIEW [db_name.]view_name SET TBLPROPERTIES table_properties;

table_properties:
  : (property_name = property_value, property_name = property_value, ...)
</code></pre></div><p>示例：</p> <div class="language- extra-class"><pre class="language-text"><code>ALTER VIEW custom_view SET TBLPROPERTIES ('create'='heibaiying','date'='2019-05-05');
</code></pre></div><p><img src="https://github.com/heibaiying/BigData-Notes/raw/master/pictures/hive-view-properties.png" alt="img"></p> <h2 id="二、索引"><a href="#二、索引" class="header-anchor">#</a> 二、索引</h2> <h3 id="简介-2"><a href="#简介-2" class="header-anchor">#</a> 简介</h3> <p>Hive 在 0.7.0 引入了索引的功能，索引的设计目标是提高表某些列的查询速度。如果没有索引，带有谓词的查询（如'WHERE table1.column = 10'）会加载整个表或分区并处理所有行。但是如果 column 存在索引，则只需要加载和处理文件的一部分。</p> <h3 id="索引原理"><a href="#索引原理" class="header-anchor">#</a> 索引原理</h3> <p>在指定列上建立索引，会产生一张索引表（表结构如下），里面的字段包括：索引列的值、该值对应的 HDFS 文件路径、该值在文件中的偏移量。在查询涉及到索引字段时，首先到索引表查找索引列值对应的 HDFS 文件路径及偏移量，这样就避免了全表扫描。</p> <div class="language- extra-class"><pre class="language-text"><code>+--------------+----------------+----------+--+
|   col_name   |   data_type    | comment     |
+--------------+----------------+----------+--+
| empno        | int            |  建立索引的列  |
| _bucketname  | string         |  HDFS 文件路径  |
| _offsets     | array&lt;bigint&gt;  |  偏移量       |
+--------------+----------------+----------+--+
</code></pre></div><h3 id="创建索引"><a href="#创建索引" class="header-anchor">#</a> 创建索引</h3> <div class="language-mssql extra-class"><pre class="language-text"><code>CREATE INDEX index_name     --索引名称
  ON TABLE base_table_name (col_name, ...)  --建立索引的列
  AS index_type    --索引类型
  [WITH DEFERRED REBUILD]    --重建索引
  [IDXPROPERTIES (property_name=property_value, ...)]  --索引额外属性
  [IN TABLE index_table_name]    --索引表的名字
  [
     [ ROW FORMAT ...] STORED AS ...
     | STORED BY ...
  ]   --索引表行分隔符 、 存储格式
  [LOCATION hdfs_path]  --索引表存储位置
  [TBLPROPERTIES (...)]   --索引表表属性
  [COMMENT &quot;index comment&quot;];  --索引注释
</code></pre></div><h3 id="查看索引"><a href="#查看索引" class="header-anchor">#</a> 查看索引</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--显示表上所有列的索引</span>
<span class="token keyword">SHOW</span> FORMATTED <span class="token keyword">INDEX</span> <span class="token keyword">ON</span> table_name<span class="token punctuation">;</span>
</code></pre></div><h3 id="删除索引"><a href="#删除索引" class="header-anchor">#</a> 删除索引</h3> <p>删除索引会删除对应的索引表。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> index_name <span class="token keyword">ON</span> table_name<span class="token punctuation">;</span>
</code></pre></div><p>如果存在索引的表被删除了，其对应的索引和索引表都会被删除。如果被索引表的某个分区被删除了，那么分区对应的分区索引也会被删除。</p> <h3 id="重建索引"><a href="#重建索引" class="header-anchor">#</a> 重建索引</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> table_name <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> partition_spec<span class="token punctuation">]</span> REBUILD<span class="token punctuation">;</span>
</code></pre></div><p>重建索引。如果指定了 PARTITION，则仅重建该分区的索引。</p> <h2 id="三、索引案例"><a href="#三、索引案例" class="header-anchor">#</a> 三、索引案例</h2> <h3 id="创建索引-2"><a href="#创建索引-2" class="header-anchor">#</a> 创建索引</h3> <p>在 emp 表上针对 <code>empno</code> 字段创建名为 <code>emp_index</code>,索引数据存储在 <code>emp_index_table</code> 索引表中</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">index</span> emp_index <span class="token keyword">on</span> <span class="token keyword">table</span> emp<span class="token punctuation">(</span>empno<span class="token punctuation">)</span> <span class="token keyword">as</span>
<span class="token string">'org.apache.hadoop.hive.ql.index.compact.CompactIndexHandler'</span>
<span class="token keyword">with</span> deferred rebuild
<span class="token operator">in</span> <span class="token keyword">table</span> emp_index_table <span class="token punctuation">;</span>
</code></pre></div><p>此时索引表中是没有数据的，需要重建索引才会有索引的数据。</p> <h3 id="重建索引-2"><a href="#重建索引-2" class="header-anchor">#</a> 重建索引</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">index</span> emp_index <span class="token keyword">on</span> emp rebuild<span class="token punctuation">;</span>
</code></pre></div><p>Hive 会启动 MapReduce 作业去建立索引，建立好后查看索引表数据如下。三个表字段分别代表：索引列的值、该值对应的 HDFS 文件路径、该值在文件中的偏移量。</p> <p><img src="https://github.com/heibaiying/BigData-Notes/raw/master/pictures/hive-index-table.png" alt="img"></p> <h3 id="自动使用索引"><a href="#自动使用索引" class="header-anchor">#</a> 自动使用索引</h3> <p>默认情况下，虽然建立了索引，但是 Hive 在查询时候是不会自动去使用索引的，需要开启相关配置。开启配置后，涉及到索引列的查询就会使用索引功能去优化查询。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SET</span> hive<span class="token punctuation">.</span>input<span class="token punctuation">.</span>format<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>ql<span class="token punctuation">.</span>io<span class="token punctuation">.</span>HiveInputFormat<span class="token punctuation">;</span>
<span class="token keyword">SET</span> hive<span class="token punctuation">.</span><span class="token keyword">optimize</span><span class="token punctuation">.</span><span class="token keyword">index</span><span class="token punctuation">.</span>filter<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> hive<span class="token punctuation">.</span><span class="token keyword">optimize</span><span class="token punctuation">.</span><span class="token keyword">index</span><span class="token punctuation">.</span>filter<span class="token punctuation">.</span>compact<span class="token punctuation">.</span>minsize<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="查看索引-2"><a href="#查看索引-2" class="header-anchor">#</a> 查看索引</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">ON</span> emp<span class="token punctuation">;</span>
</code></pre></div><p><img src="https://github.com/heibaiying/BigData-Notes/raw/master/pictures/hive-index-show.png" alt="img"></p> <h2 id="四、索引的缺陷"><a href="#四、索引的缺陷" class="header-anchor">#</a> 四、索引的缺陷</h2> <p>索引表最主要的一个缺陷在于：索引表无法自动 rebuild，这也就意味着如果表中有数据新增或删除，则必须手动 rebuild，重新执行 MapReduce 作业，生成索引表数据。</p> <p>同时按照<a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Indexing" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的说明，Hive 会从 3.0 开始移除索引功能，主要基于以下两个原因：</p> <ul><li>具有自动重写的物化视图 (Materialized View) 可以产生与索引相似的效果（Hive 2.3.0 增加了对物化视图的支持，在 3.0 之后正式引入）。</li> <li>使用列式存储文件格式（Parquet，ORC）进行存储时，这些格式支持选择性扫描，可以跳过不需要的文件或块。</li></ul> <blockquote><p>ORC 内置的索引功能可以参阅这篇文章：<a href="http://lxw1234.com/archives/2016/04/632.htm" target="_blank" rel="noopener noreferrer">Hive 性能优化之 ORC 索引–Row Group Index vs Bloom Filter Index<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-Create/Drop/AlterView" target="_blank" rel="noopener noreferrer">Create/Drop/Alter View<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cwiki.apache.org/confluence/display/Hive/Materialized+views" target="_blank" rel="noopener noreferrer">Materialized views<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://lxw1234.com/archives/2015/05/207.htm" target="_blank" rel="noopener noreferrer">Hive 索引<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Indexing" target="_blank" rel="noopener noreferrer">Overview of Hive Indexes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/bigdata-tutorial/edit/master/docs/hive/hive-index-and-view.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2 years ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/bigdata-tutorial/assets/js/app.3ada26ba.js" defer></script><script src="/bigdata-tutorial/assets/js/4.cda5e0f1.js" defer></script><script src="/bigdata-tutorial/assets/js/34.811f6626.js" defer></script><script src="/bigdata-tutorial/assets/js/5.9d6e4fe2.js" defer></script>
  </body>
</html>
