<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flink ETL | BIGDATA-TUTORIAL</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/bigdata-tutorial/favicon.ico">
    <meta name="description" content="å¤§æ•°æ®æ•™ç¨‹">
    
    <link rel="preload" href="/bigdata-tutorial/assets/css/0.styles.eecf7a64.css" as="style"><link rel="preload" href="/bigdata-tutorial/assets/js/app.3ada26ba.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/4.cda5e0f1.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/13.1b26207d.js" as="script"><link rel="preload" href="/bigdata-tutorial/assets/js/5.9d6e4fe2.js" as="script"><link rel="prefetch" href="/bigdata-tutorial/assets/js/10.1ab7bd74.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/11.a42f7604.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/12.7dce2ed8.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/14.a9835374.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/15.90c66596.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/16.e0471453.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/17.2c0565cb.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/18.fabbce00.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/19.c120a108.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/20.5a4f48af.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/21.d3fce730.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/22.00ac574a.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/23.754595c9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/24.fc9d31a1.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/25.d4313bcb.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/26.604f045b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/27.22a239b2.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/28.466b9a71.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/29.2783ebfd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/30.2ff3250e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/31.2c64e404.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/32.0ab8b31c.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/33.be38d2dc.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/34.811f6626.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/35.9d9f3847.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/36.32bb3f84.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/37.db182f29.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/38.91a9d6f3.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/39.1148f971.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/40.1536c75c.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/41.31725066.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/42.68e59bdd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/43.9bac72d5.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/44.a2edd3e0.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/45.4a1cf2ae.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/46.d8a80a79.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/47.9621b1a5.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/48.56d4fa14.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/49.d9d143dd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/50.6e4aa6cd.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/51.55771fda.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/52.ee51188b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/53.b014e486.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/54.ae66c176.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/55.2ea9bfd9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/56.ffb4a04b.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/57.bdee2f7e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/58.982c2219.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/59.c006237e.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/6.3bb0b816.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/60.b27dc3c8.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/7.d55602d2.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/8.89e9ace9.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/9.0c40eb95.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/vendors~flowchart.5998caa6.js"><link rel="prefetch" href="/bigdata-tutorial/assets/js/vendors~notification.943e54fe.js">
    <link rel="stylesheet" href="/bigdata-tutorial/assets/css/0.styles.eecf7a64.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bigdata-tutorial/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo-200.png" alt="BIGDATA-TUTORIAL" class="logo"> <span class="site-name can-hide">BIGDATA-TUTORIAL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/bigdata-tutorial/hive/" class="nav-link">
  Hive
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hdfs/" class="nav-link">
  Hdfs
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hbase/" class="nav-link">
  Hbase
</a></div><div class="nav-item"><a href="/bigdata-tutorial/zookeeper/" class="nav-link">
  ZooKeeper
</a></div><div class="nav-item"><a href="/bigdata-tutorial/kafka/" class="nav-link">
  Kafka
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javatech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/bigdata-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/bigdata-tutorial/hive/" class="nav-link">
  Hive
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hdfs/" class="nav-link">
  Hdfs
</a></div><div class="nav-item"><a href="/bigdata-tutorial/hbase/" class="nav-link">
  Hbase
</a></div><div class="nav-item"><a href="/bigdata-tutorial/zookeeper/" class="nav-link">
  ZooKeeper
</a></div><div class="nav-item"><a href="/bigdata-tutorial/kafka/" class="nav-link">
  Kafka
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">âœ¨ Javaç³»åˆ—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javatech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot æ•™ç¨‹ ğŸ“š
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/bigdata-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Flink ETL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata-tutorial/flink/FlinkETL.html#æ— çŠ¶æ€çš„è½¬æ¢" class="sidebar-link">æ— çŠ¶æ€çš„è½¬æ¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#map" class="sidebar-link">map()</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#flatmap" class="sidebar-link">flatmap()</a></li></ul></li><li><a href="/bigdata-tutorial/flink/FlinkETL.html#keyed-streams" class="sidebar-link">Keyed Streams</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#keyby" class="sidebar-link">keyBy()</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#é€šè¿‡è®¡ç®—å¾—åˆ°é”®" class="sidebar-link">é€šè¿‡è®¡ç®—å¾—åˆ°é”®</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#keyed-stream-çš„èšåˆ" class="sidebar-link">Keyed Stream çš„èšåˆ</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#éšå¼çš„-çŠ¶æ€" class="sidebar-link">ï¼ˆéšå¼çš„ï¼‰çŠ¶æ€</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#reduce-å’Œå…¶ä»–èšåˆç®—å­" class="sidebar-link">reduce() å’Œå…¶ä»–èšåˆç®—å­</a></li></ul></li><li><a href="/bigdata-tutorial/flink/FlinkETL.html#æœ‰çŠ¶æ€çš„è½¬æ¢" class="sidebar-link">æœ‰çŠ¶æ€çš„è½¬æ¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#flink-ä¸ºä»€ä¹ˆè¦å‚ä¸çŠ¶æ€ç®¡ç†" class="sidebar-link">Flink ä¸ºä»€ä¹ˆè¦å‚ä¸çŠ¶æ€ç®¡ç†ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#rich-functions" class="sidebar-link">Rich Functions</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#ä¸€ä¸ªä½¿ç”¨-keyed-state-çš„ä¾‹å­" class="sidebar-link">ä¸€ä¸ªä½¿ç”¨ Keyed State çš„ä¾‹å­</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#æ¸…ç†çŠ¶æ€" class="sidebar-link">æ¸…ç†çŠ¶æ€</a></li><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#non-keyed-state" class="sidebar-link">Non-keyed State</a></li></ul></li><li><a href="/bigdata-tutorial/flink/FlinkETL.html#connected-streams" class="sidebar-link">Connected Streams</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bigdata-tutorial/flink/FlinkETL.html#ç¤ºä¾‹" class="sidebar-link">ç¤ºä¾‹</a></li></ul></li><li><a href="/bigdata-tutorial/flink/FlinkETL.html#å‚è€ƒèµ„æ–™" class="sidebar-link">å‚è€ƒèµ„æ–™</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="flink-etl"><a href="#flink-etl" class="header-anchor">#</a> Flink ETL</h1> <p>Apache Flink çš„ä¸€ç§å¸¸è§åº”ç”¨åœºæ™¯æ˜¯ ETLï¼ˆæŠ½å–ã€è½¬æ¢ã€åŠ è½½ï¼‰ç®¡é“ä»»åŠ¡ã€‚ä»ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®æºè·å–æ•°æ®ï¼Œè¿›è¡Œä¸€äº›è½¬æ¢æ“ä½œå’Œä¿¡æ¯è¡¥å……ï¼Œå°†ç»“æœå­˜å‚¨èµ·æ¥ã€‚åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Flink çš„ DataStream API å®ç°è¿™ç±»åº”ç”¨ã€‚</p> <p>è¿™é‡Œæ³¨æ„ï¼ŒFlink çš„ <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/dev/table/overview/" target="_blank" rel="noopener noreferrer">Table å’Œ SQL API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å®Œå…¨å¯ä»¥æ»¡è¶³å¾ˆå¤š ETL ä½¿ç”¨åœºæ™¯ã€‚ä½†æ— è®ºä½ æœ€ç»ˆæ˜¯å¦ç›´æ¥ä½¿ç”¨ DataStream APIï¼Œå¯¹è¿™é‡Œä»‹ç»çš„åŸºæœ¬çŸ¥è¯†æœ‰æ‰å®çš„ç†è§£éƒ½æ˜¯æœ‰ä»·å€¼çš„ã€‚</p> <h2 id="æ— çŠ¶æ€çš„è½¬æ¢"><a href="#æ— çŠ¶æ€çš„è½¬æ¢" class="header-anchor">#</a> æ— çŠ¶æ€çš„è½¬æ¢</h2> <p>æœ¬èŠ‚æ¶µç›–äº† <code>map()</code> å’Œ <code>flatmap()</code>ï¼Œè¿™ä¸¤ç§ç®—å­å¯ä»¥ç”¨æ¥å®ç°æ— çŠ¶æ€è½¬æ¢çš„åŸºæœ¬æ“ä½œã€‚</p> <h3 id="map"><a href="#map" class="header-anchor">#</a> <code>map()</code></h3> <p>åœ¨ç¬¬ä¸€ä¸ªç»ƒä¹ ä¸­ï¼Œä½ å°†è¿‡æ»¤å‡ºç§Ÿè½¦è¡Œç¨‹æ•°æ®ä¸­çš„äº‹ä»¶ã€‚åœ¨åŒä¸€ä»£ç ä»“åº“ä¸­ï¼Œæœ‰ä¸€ä¸ª <code>GeoUtils</code> ç±»ï¼Œæä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³• <code>GeoUtils.mapToGridCell(float lon, float lat)</code>ï¼Œå®ƒå¯ä»¥å°†ä½ç½®åæ ‡ï¼ˆç»åº¦ï¼Œç»´åº¦ï¼‰æ˜ å°„åˆ° 100x100 ç±³çš„å¯¹åº”ä¸åŒåŒºåŸŸçš„ç½‘æ ¼å•å…ƒã€‚</p> <p>ç°åœ¨è®©æˆ‘ä»¬ä¸ºæ¯ä¸ªå‡ºç§Ÿè½¦è¡Œç¨‹æ—¶é—´çš„æ•°æ®å¯¹è±¡å¢åŠ  <code>startCell</code> å’Œ <code>endCell</code> å­—æ®µã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªç»§æ‰¿ <code>TaxiRide</code> çš„ <code>EnrichedRide</code> ç±»ï¼Œæ·»åŠ è¿™äº›å­—æ®µï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">EnrichedRide</span> <span class="token keyword">extends</span> <span class="token class-name">TaxiRide</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> startCell<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> endCell<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">EnrichedRide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">EnrichedRide</span><span class="token punctuation">(</span><span class="token class-name">TaxiRide</span> ride<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>rideId <span class="token operator">=</span> ride<span class="token punctuation">.</span>rideId<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>isStart <span class="token operator">=</span> ride<span class="token punctuation">.</span>isStart<span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>startCell <span class="token operator">=</span> <span class="token class-name">GeoUtils</span><span class="token punctuation">.</span><span class="token function">mapToGridCell</span><span class="token punctuation">(</span>ride<span class="token punctuation">.</span>startLon<span class="token punctuation">,</span> ride<span class="token punctuation">.</span>startLat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>endCell <span class="token operator">=</span> <span class="token class-name">GeoUtils</span><span class="token punctuation">.</span><span class="token function">mapToGridCell</span><span class="token punctuation">(</span>ride<span class="token punctuation">.</span>endLon<span class="token punctuation">,</span> ride<span class="token punctuation">.</span>endLat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">+</span>
            <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startCell<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">+</span>
            <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>endCell<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶åä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªåº”ç”¨æ¥è½¬æ¢è¿™ä¸ªæµ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TaxiRide</span><span class="token punctuation">&gt;</span></span> rides <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TaxiRideSource</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EnrichedRide</span><span class="token punctuation">&gt;</span></span> enrichedNYCRides <span class="token operator">=</span> rides
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RideCleansingSolution<span class="token punctuation">.</span>NYCFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Enrichment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

enrichedNYCRides<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä½¿ç”¨è¿™ä¸ª <code>MapFunction</code>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Enrichment</span> <span class="token keyword">implements</span> <span class="token class-name">MapFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TaxiRide</span><span class="token punctuation">,</span> <span class="token class-name">EnrichedRide</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">EnrichedRide</span> <span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">TaxiRide</span> taxiRide<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">EnrichedRide</span><span class="token punctuation">(</span>taxiRide<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="flatmap"><a href="#flatmap" class="header-anchor">#</a> <code>flatmap()</code></h3> <p><code>MapFunction</code> åªé€‚ç”¨äºä¸€å¯¹ä¸€çš„è½¬æ¢ï¼šå¯¹æ¯ä¸ªè¿›å…¥ç®—å­çš„æµå…ƒç´ ï¼Œ<code>map()</code> å°†ä»…è¾“å‡ºä¸€ä¸ªè½¬æ¢åçš„å…ƒç´ ã€‚å¯¹äºé™¤æ­¤ä»¥å¤–çš„åœºæ™¯ï¼Œä½ å°†è¦ä½¿ç”¨ <code>flatmap()</code>ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TaxiRide</span><span class="token punctuation">&gt;</span></span> rides <span class="token operator">=</span> env<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TaxiRideSource</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EnrichedRide</span><span class="token punctuation">&gt;</span></span> enrichedNYCRides <span class="token operator">=</span> rides
    <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NYCEnrichment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

enrichedNYCRides<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å…¶ä¸­ç”¨åˆ°çš„ <code>FlatMapFunction</code> :</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">NYCEnrichment</span> <span class="token keyword">implements</span> <span class="token class-name">FlatMapFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TaxiRide</span><span class="token punctuation">,</span> <span class="token class-name">EnrichedRide</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">TaxiRide</span> taxiRide<span class="token punctuation">,</span> <span class="token class-name">Collector</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EnrichedRide</span><span class="token punctuation">&gt;</span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">FilterFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TaxiRide</span><span class="token punctuation">&gt;</span></span> valid <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RideCleansing<span class="token punctuation">.</span>NYCFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>valid<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>taxiRide<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            out<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EnrichedRide</span><span class="token punctuation">(</span>taxiRide<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä½¿ç”¨æ¥å£ä¸­æä¾›çš„ <code>Collector</code> ï¼Œ<code>flatmap()</code> å¯ä»¥è¾“å‡ºä½ æƒ³è¦çš„ä»»æ„æ•°é‡çš„å…ƒç´ ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ªéƒ½ä¸å‘ã€‚</p> <h2 id="keyed-streams"><a href="#keyed-streams" class="header-anchor">#</a> Keyed Streams</h2> <h3 id="keyby"><a href="#keyby" class="header-anchor">#</a> <code>keyBy()</code></h3> <p>å°†ä¸€ä¸ªæµæ ¹æ®å…¶ä¸­çš„ä¸€äº›å±æ€§æ¥è¿›è¡Œåˆ†åŒºæ˜¯ååˆ†æœ‰ç”¨çš„ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿æ‰€æœ‰å…·æœ‰ç›¸åŒå±æ€§çš„äº‹ä»¶åˆ†åˆ°ç›¸åŒçš„ç»„é‡Œã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³æ‰¾åˆ°ä»æ¯ä¸ªç½‘æ ¼å•å…ƒå‡ºå‘çš„æœ€è¿œçš„å‡ºç§Ÿè½¦è¡Œç¨‹ã€‚æŒ‰ SQL æŸ¥è¯¢çš„æ–¹å¼æ¥è€ƒè™‘ï¼Œè¿™æ„å‘³ç€è¦å¯¹ <code>startCell</code> è¿›è¡Œ GROUP BY å†æ’åºï¼Œåœ¨ Flink ä¸­è¿™éƒ¨åˆ†å¯ä»¥ç”¨ <code>keyBy(KeySelector)</code> å®ç°ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>rides
    <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">NYCEnrichment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>enrichedRide <span class="token operator">-&gt;</span> enrichedRide<span class="token punctuation">.</span>startCell<span class="token punctuation">)</span>
</code></pre></div><p>æ¯ä¸ª <code>keyBy</code> ä¼šé€šè¿‡ shuffle æ¥ä¸ºæ•°æ®æµè¿›è¡Œé‡æ–°åˆ†åŒºã€‚æ€»ä½“æ¥è¯´è¿™ä¸ªå¼€é”€æ˜¯å¾ˆå¤§çš„ï¼Œå®ƒæ¶‰åŠç½‘ç»œé€šä¿¡ã€åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p> <p><img src="https://nightlies.apache.org/flink/flink-docs-release-1.14/fig/keyBy.png" alt="keyBy and network shuffle"></p> <h3 id="é€šè¿‡è®¡ç®—å¾—åˆ°é”®"><a href="#é€šè¿‡è®¡ç®—å¾—åˆ°é”®" class="header-anchor">#</a> é€šè¿‡è®¡ç®—å¾—åˆ°é”®</h3> <p>KeySelector ä¸ä»…é™äºä»äº‹ä»¶ä¸­æŠ½å–é”®ã€‚ä½ ä¹Ÿå¯ä»¥æŒ‰æƒ³è¦çš„æ–¹å¼è®¡ç®—å¾—åˆ°é”®å€¼ï¼Œåªè¦æœ€ç»ˆç»“æœæ˜¯ç¡®å®šçš„ï¼Œå¹¶ä¸”å®ç°äº† <code>hashCode()</code> å’Œ <code>equals()</code>ã€‚è¿™äº›é™åˆ¶æ¡ä»¶ä¸åŒ…æ‹¬äº§ç”Ÿéšæœºæ•°æˆ–è€…è¿”å› Arrays æˆ– Enums çš„ KeySelectorï¼Œä½†ä½ å¯ä»¥ç”¨å…ƒç»„å’Œ POJO æ¥ç»„æˆé”®ï¼Œåªè¦ä»–ä»¬çš„å…ƒç´ éµå¾ªä¸Šè¿°æ¡ä»¶ã€‚</p> <p>é”®å¿…é¡»æŒ‰ç¡®å®šçš„æ–¹å¼äº§ç”Ÿï¼Œå› ä¸ºå®ƒä»¬ä¼šåœ¨éœ€è¦çš„æ—¶å€™è¢«é‡æ–°è®¡ç®—ï¼Œè€Œä¸æ˜¯ä¸€ç›´è¢«å¸¦åœ¨æµè®°å½•ä¸­ã€‚</p> <p>ä¾‹å¦‚ï¼Œæ¯”èµ·åˆ›å»ºä¸€ä¸ªæ–°çš„å¸¦æœ‰ <code>startCell</code> å­—æ®µçš„ <code>EnrichedRide</code> ç±»ï¼Œç”¨è¿™ä¸ªå­—æ®µä½œä¸º keyï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">keyBy</span><span class="token punctuation">(</span>enrichedRide <span class="token operator">-&gt;</span> enrichedRide<span class="token punctuation">.</span>startCell<span class="token punctuation">)</span>
</code></pre></div><p>æˆ‘ä»¬æ›´å€¾å‘äºè¿™æ ·åšï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token function">keyBy</span><span class="token punctuation">(</span>ride <span class="token operator">-&gt;</span> <span class="token class-name">GeoUtils</span><span class="token punctuation">.</span><span class="token function">mapToGridCell</span><span class="token punctuation">(</span>ride<span class="token punctuation">.</span>startLon<span class="token punctuation">,</span> ride<span class="token punctuation">.</span>startLat<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="keyed-stream-çš„èšåˆ"><a href="#keyed-stream-çš„èšåˆ" class="header-anchor">#</a> Keyed Stream çš„èšåˆ</h3> <p>ä»¥ä¸‹ä»£ç ä¸ºæ¯ä¸ªè¡Œç¨‹ç»“æŸäº‹ä»¶åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åŒ…å« <code>startCell</code> å’Œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰çš„å…ƒç»„æµï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>joda<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Interval</span><span class="token punctuation">;</span>

<span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple2</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Minutes</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> minutesByStartCell <span class="token operator">=</span> enrichedNYCRides
    <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FlatMapFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EnrichedRide</span><span class="token punctuation">,</span> <span class="token class-name">Tuple2</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Minutes</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">EnrichedRide</span> ride<span class="token punctuation">,</span>
                            <span class="token class-name">Collector</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tuple2</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">Minutes</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ride<span class="token punctuation">.</span>isStart<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Interval</span> rideInterval <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Interval</span><span class="token punctuation">(</span>ride<span class="token punctuation">.</span>startTime<span class="token punctuation">,</span> ride<span class="token punctuation">.</span>endTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Minutes</span> duration <span class="token operator">=</span> rideInterval<span class="token punctuation">.</span><span class="token function">toDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toStandardMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                out<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Tuple2</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>ride<span class="token punctuation">.</span>startCell<span class="token punctuation">,</span> duration<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç°åœ¨å°±å¯ä»¥äº§ç”Ÿä¸€ä¸ªæµï¼Œå¯¹æ¯ä¸ª <code>startCell</code> ä»…åŒ…å«é‚£äº›æœ€é•¿è¡Œç¨‹çš„æ•°æ®ã€‚</p> <p>æœ‰å¾ˆå¤šç§æ–¹æ³•è¡¨ç¤ºä½¿ç”¨å“ªä¸ªå­—æ®µä½œä¸ºé”®ã€‚å‰é¢ä½¿ç”¨ <code>EnrichedRide</code> POJO çš„ä¾‹å­ï¼Œç”¨å­—æ®µåæ¥æŒ‡å®šé”®ã€‚è€Œè¿™ä¸ªä½¿ç”¨ <code>Tuple2</code> å¯¹è±¡çš„ä¾‹å­ä¸­ï¼Œç”¨å­—æ®µåœ¨å…ƒç»„ä¸­çš„åºå·ï¼ˆä» 0 å¼€å§‹ï¼‰æ¥æŒ‡å®šé”®ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code>minutesByStartCell
  <span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>value <span class="token operator">-&gt;</span> value<span class="token punctuation">.</span>f0<span class="token punctuation">)</span> <span class="token comment">// .keyBy(value -&gt; value.startCell)</span>
  <span class="token punctuation">.</span><span class="token function">maxBy</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// duration</span>
  <span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç°åœ¨æ¯æ¬¡è¡Œç¨‹æ—¶é•¿è¾¾åˆ°æ–°çš„æœ€å¤§å€¼ï¼Œéƒ½ä¼šè¾“å‡ºä¸€æ¡æ–°è®°å½•ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªå¯¹åº” 50797 ç½‘æ ¼å•å…ƒçš„æ•°æ®ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>...
4&gt; (64549,5M)
4&gt; (46298,18M)
1&gt; (51549,14M)
1&gt; (53043,13M)
1&gt; (56031,22M)
1&gt; (50797,6M)
...
1&gt; (50797,8M)
...
1&gt; (50797,11M)
...
1&gt; (50797,12M)
</code></pre></div><h3 id="éšå¼çš„-çŠ¶æ€"><a href="#éšå¼çš„-çŠ¶æ€" class="header-anchor">#</a> ï¼ˆéšå¼çš„ï¼‰çŠ¶æ€</h3> <p>è¿™æ˜¯åŸ¹è®­ä¸­ç¬¬ä¸€ä¸ªæ¶‰åŠåˆ°æœ‰çŠ¶æ€æµçš„ä¾‹å­ã€‚å°½ç®¡çŠ¶æ€çš„å¤„ç†æ˜¯é€æ˜çš„ï¼ŒFlink å¿…é¡»è·Ÿè¸ªæ¯ä¸ªä¸åŒçš„é”®çš„æœ€å¤§æ—¶é•¿ã€‚</p> <p>åªè¦åº”ç”¨ä¸­æœ‰çŠ¶æ€ï¼Œä½ å°±åº”è¯¥è€ƒè™‘çŠ¶æ€çš„å¤§å°ã€‚å¦‚æœé”®å€¼çš„æ•°é‡æ˜¯æ— é™çš„ï¼Œé‚£ Flink çš„çŠ¶æ€éœ€è¦çš„ç©ºé—´ä¹ŸåŒæ ·æ˜¯æ— é™çš„ã€‚</p> <p>åœ¨æµå¤„ç†åœºæ™¯ä¸­ï¼Œè€ƒè™‘æœ‰é™çª—å£çš„èšåˆå¾€å¾€æ¯”æ•´ä¸ªæµèšåˆæ›´æœ‰æ„ä¹‰ã€‚</p> <h3 id="reduce-å’Œå…¶ä»–èšåˆç®—å­"><a href="#reduce-å’Œå…¶ä»–èšåˆç®—å­" class="header-anchor">#</a> <code>reduce()</code> å’Œå…¶ä»–èšåˆç®—å­</h3> <p>ä¸Šé¢ç”¨åˆ°çš„ <code>maxBy()</code> åªæ˜¯ Flink ä¸­ <code>KeyedStream</code> ä¸Šä¼—å¤šèšåˆå‡½æ•°ä¸­çš„ä¸€ä¸ªã€‚è¿˜æœ‰ä¸€ä¸ªæ›´é€šç”¨çš„ <code>reduce()</code> å‡½æ•°å¯ä»¥ç”¨æ¥å®ç°ä½ çš„è‡ªå®šä¹‰èšåˆã€‚</p> <h2 id="æœ‰çŠ¶æ€çš„è½¬æ¢"><a href="#æœ‰çŠ¶æ€çš„è½¬æ¢" class="header-anchor">#</a> æœ‰çŠ¶æ€çš„è½¬æ¢</h2> <h3 id="flink-ä¸ºä»€ä¹ˆè¦å‚ä¸çŠ¶æ€ç®¡ç†"><a href="#flink-ä¸ºä»€ä¹ˆè¦å‚ä¸çŠ¶æ€ç®¡ç†" class="header-anchor">#</a> Flink ä¸ºä»€ä¹ˆè¦å‚ä¸çŠ¶æ€ç®¡ç†ï¼Ÿ</h3> <p>åœ¨ Flink ä¸å‚ä¸ç®¡ç†çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œä½ çš„åº”ç”¨ä¹Ÿå¯ä»¥ä½¿ç”¨çŠ¶æ€ï¼Œä½† Flink ä¸ºå…¶ç®¡ç†çŠ¶æ€æä¾›äº†ä¸€äº›å¼•äººæ³¨ç›®çš„ç‰¹æ€§ï¼š</p> <ul><li><strong>æœ¬åœ°æ€§</strong>: Flink çŠ¶æ€æ˜¯å­˜å‚¨åœ¨ä½¿ç”¨å®ƒçš„æœºå™¨æœ¬åœ°çš„ï¼Œå¹¶ä¸”å¯ä»¥ä»¥å†…å­˜è®¿é—®é€Ÿåº¦æ¥è·å–</li> <li><strong>æŒä¹…æ€§</strong>: Flink çŠ¶æ€æ˜¯å®¹é”™çš„ï¼Œä¾‹å¦‚ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨æŒ‰ä¸€å®šçš„æ—¶é—´é—´éš”äº§ç”Ÿ checkpointï¼Œå¹¶ä¸”åœ¨ä»»åŠ¡å¤±è´¥åè¿›è¡Œæ¢å¤</li> <li><strong>çºµå‘å¯æ‰©å±•æ€§</strong>: Flink çŠ¶æ€å¯ä»¥å­˜å‚¨åœ¨é›†æˆçš„ RocksDB å®ä¾‹ä¸­ï¼Œè¿™ç§æ–¹å¼ä¸‹å¯ä»¥é€šè¿‡å¢åŠ æœ¬åœ°ç£ç›˜æ¥æ‰©å±•ç©ºé—´</li> <li><strong>æ¨ªå‘å¯æ‰©å±•æ€§</strong>: Flink çŠ¶æ€å¯ä»¥éšç€é›†ç¾¤çš„æ‰©ç¼©å®¹é‡æ–°åˆ†å¸ƒ</li> <li><strong>å¯æŸ¥è¯¢æ€§</strong>: Flink çŠ¶æ€å¯ä»¥é€šè¿‡ä½¿ç”¨ <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/dev/datastream/fault-tolerance/queryable_state/" target="_blank" rel="noopener noreferrer">çŠ¶æ€æŸ¥è¯¢ API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä»å¤–éƒ¨è¿›è¡ŒæŸ¥è¯¢ã€‚</li></ul> <p>åœ¨æœ¬èŠ‚ä¸­ä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Flink çš„ API æ¥ç®¡ç† keyed stateã€‚</p> <h3 id="rich-functions"><a href="#rich-functions" class="header-anchor">#</a> Rich Functions</h3> <p>è‡³æ­¤ï¼Œä½ å·²ç»çœ‹åˆ°äº† Flink çš„å‡ ç§å‡½æ•°æ¥å£ï¼ŒåŒ…æ‹¬ <code>FilterFunction</code>ï¼Œ <code>MapFunction</code>ï¼Œå’Œ <code>FlatMapFunction</code>ã€‚è¿™äº›éƒ½æ˜¯å•ä¸€æŠ½è±¡æ–¹æ³•æ¨¡å¼ã€‚</p> <p>å¯¹å…¶ä¸­çš„æ¯ä¸€ä¸ªæ¥å£ï¼ŒFlink åŒæ ·æä¾›äº†ä¸€ä¸ªæ‰€è°“ â€œrichâ€ çš„å˜ä½“ï¼Œå¦‚ <code>RichFlatMapFunction</code>ï¼Œå…¶ä¸­å¢åŠ äº†ä»¥ä¸‹æ–¹æ³•ï¼ŒåŒ…æ‹¬ï¼š</p> <ul><li><code>open(Configuration c)</code></li> <li><code>close()</code></li> <li><code>getRuntimeContext()</code></li></ul> <p><code>open()</code> ä»…åœ¨ç®—å­åˆå§‹åŒ–æ—¶è°ƒç”¨ä¸€æ¬¡ã€‚å¯ä»¥ç”¨æ¥åŠ è½½ä¸€äº›é™æ€æ•°æ®ï¼Œæˆ–è€…å»ºç«‹å¤–éƒ¨æœåŠ¡çš„é“¾æ¥ç­‰ã€‚</p> <p><code>getRuntimeContext()</code> ä¸ºæ•´å¥—æ½œåœ¨æœ‰è¶£çš„ä¸œè¥¿æä¾›äº†ä¸€ä¸ªè®¿é—®é€”å¾„ï¼Œæœ€æ˜æ˜¾çš„ï¼Œå®ƒæ˜¯ä½ åˆ›å»ºå’Œè®¿é—® Flink çŠ¶æ€çš„é€”å¾„ã€‚</p> <h3 id="ä¸€ä¸ªä½¿ç”¨-keyed-state-çš„ä¾‹å­"><a href="#ä¸€ä¸ªä½¿ç”¨-keyed-state-çš„ä¾‹å­" class="header-anchor">#</a> ä¸€ä¸ªä½¿ç”¨ Keyed State çš„ä¾‹å­</h3> <p>åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæƒ³è±¡ä½ æœ‰ä¸€ä¸ªè¦å»é‡çš„äº‹ä»¶æ•°æ®æµï¼Œå¯¹æ¯ä¸ªé”®åªä¿ç•™ç¬¬ä¸€ä¸ªäº‹ä»¶ã€‚ä¸‹é¢æ˜¯å®Œæˆè¿™ä¸ªåŠŸèƒ½çš„åº”ç”¨ï¼Œä½¿ç”¨ä¸€ä¸ªåä¸º <code>Deduplicator</code> çš„ <code>RichFlatMapFunction</code> ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Event</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> key<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">long</span> timestamp<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">StreamExecutionEnvironment</span> env <span class="token operator">=</span> <span class="token class-name">StreamExecutionEnvironment</span><span class="token punctuation">.</span><span class="token function">getExecutionEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    env<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>e <span class="token operator">-&gt;</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Deduplicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    env<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸ºäº†å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œ<code>Deduplicator</code> éœ€è¦è®°å½•æ¯ä¸ªé”®æ˜¯å¦å·²ç»æœ‰äº†ç›¸åº”çš„è®°å½•ã€‚å®ƒå°†é€šè¿‡ä½¿ç”¨ Flink çš„ <em>keyed state</em> æ¥å£æ¥åšè¿™ä»¶äº‹ã€‚</p> <p>å½“ä½ ä½¿ç”¨åƒè¿™æ ·çš„ keyed stream çš„æ—¶å€™ï¼ŒFlink ä¼šä¸ºæ¯ä¸ªçŠ¶æ€ä¸­ç®¡ç†çš„æ¡ç›®ç»´æŠ¤ä¸€ä¸ªé”®å€¼å­˜å‚¨ã€‚</p> <p>Flink æ”¯æŒå‡ ç§ä¸åŒæ–¹å¼çš„ keyed stateï¼Œè¿™ä¸ªä¾‹å­ä½¿ç”¨çš„æ˜¯æœ€ç®€å•çš„ä¸€ä¸ªï¼Œå«åš <code>ValueState</code>ã€‚æ„æ€æ˜¯å¯¹äº <em>æ¯ä¸ªé”®</em> ï¼ŒFlink å°†å­˜å‚¨ä¸€ä¸ªå•ä¸€çš„å¯¹è±¡ â€”â€” åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå­˜å‚¨çš„æ˜¯ä¸€ä¸ª <code>Boolean</code> ç±»å‹çš„å¯¹è±¡ã€‚</p> <p>æˆ‘ä»¬çš„ <code>Deduplicator</code> ç±»æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š<code>open()</code> å’Œ <code>flatMap()</code>ã€‚<code>open()</code> æ–¹æ³•é€šè¿‡å®šä¹‰ <code>ValueStateDescriptor&lt;Boolean&gt;</code> å»ºç«‹äº†ç®¡ç†çŠ¶æ€çš„ä½¿ç”¨ã€‚æ„é€ å™¨çš„å‚æ•°å®šä¹‰äº†è¿™ä¸ªçŠ¶æ€çš„åå­—ï¼ˆâ€œkeyHasBeenSeenâ€ï¼‰ï¼Œå¹¶ä¸”ä¸ºå¦‚ä½•åºåˆ—åŒ–è¿™äº›å¯¹è±¡æä¾›äº†ä¿¡æ¯ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­çš„ <code>Types.BOOLEAN</code>ï¼‰ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Deduplicator</span> <span class="token keyword">extends</span> <span class="token class-name">RichFlatMapFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">,</span> <span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">ValueState</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> keyHasBeenSeen<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token class-name">Configuration</span> conf<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ValueStateDescriptor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> desc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ValueStateDescriptor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;keyHasBeenSeen&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span>BOOLEAN<span class="token punctuation">)</span><span class="token punctuation">;</span>
        keyHasBeenSeen <span class="token operator">=</span> <span class="token function">getRuntimeContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">Event</span> event<span class="token punctuation">,</span> <span class="token class-name">Collector</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Event</span><span class="token punctuation">&gt;</span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>keyHasBeenSeen<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            out<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
            keyHasBeenSeen<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å½“ flatMap æ–¹æ³•è°ƒç”¨ <code>keyHasBeenSeen.value()</code> æ—¶ï¼ŒFlink ä¼šåœ¨ <em>å½“å‰é”®çš„ä¸Šä¸‹æ–‡</em> ä¸­æ£€ç´¢çŠ¶æ€å€¼ï¼Œåªæœ‰å½“çŠ¶æ€ä¸º <code>null</code> æ—¶ï¼Œæ‰ä¼šè¾“å‡ºå½“å‰äº‹ä»¶ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒåŒæ—¶ä¹Ÿå°†æ›´æ–° <code>keyHasBeenSeen</code> ä¸º <code>true</code>ã€‚</p> <p>è¿™ç§è®¿é—®å’Œæ›´æ–°æŒ‰é”®åˆ†åŒºçš„çŠ¶æ€çš„æœºåˆ¶ä¹Ÿè®¸çœ‹ä¸Šå»å¾ˆç¥å¥‡ï¼Œå› ä¸ºåœ¨ <code>Deduplicator</code> çš„å®ç°ä¸­ï¼Œé”®ä¸æ˜¯æ˜ç¡®å¯è§çš„ã€‚å½“ Flink è¿è¡Œæ—¶è°ƒç”¨ <code>RichFlatMapFunction</code> çš„ <code>open</code> æ–¹æ³•æ—¶ï¼Œ æ˜¯æ²¡æœ‰äº‹ä»¶çš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¸Šä¸‹æ–‡ä¸­ä¸å«æœ‰ä»»ä½•é”®ã€‚ä½†å½“å®ƒè°ƒç”¨ <code>flatMap</code> æ–¹æ³•ï¼Œè¢«å¤„ç†çš„äº‹ä»¶çš„é”®åœ¨è¿è¡Œæ—¶ä¸­å°±æ˜¯å¯ç”¨çš„äº†ï¼Œå¹¶ä¸”è¢«ç”¨æ¥ç¡®å®šæ“ä½œå“ªä¸ª Flink çŠ¶æ€åç«¯çš„å…¥å£ã€‚</p> <p>éƒ¨ç½²åœ¨åˆ†å¸ƒå¼é›†ç¾¤æ—¶ï¼Œå°†ä¼šæœ‰å¾ˆå¤š <code>Deduplicator</code> çš„å®ä¾‹ï¼Œæ¯ä¸€ä¸ªå®ä¾‹å°†è´Ÿè´£æ•´ä¸ªé”®ç©ºé—´çš„äº’æ–¥å­é›†ä¸­çš„ä¸€ä¸ªã€‚æ‰€ä»¥ï¼Œå½“ä½ çœ‹åˆ°ä¸€ä¸ªå•ç‹¬çš„ <code>ValueState</code>ï¼Œæ¯”å¦‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ValueState</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> keyHasBeenSeen<span class="token punctuation">;</span>
</code></pre></div><p>è¦ç†è§£è¿™ä¸ªä»£è¡¨çš„ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå•ç‹¬çš„å¸ƒå°”ç±»å‹å˜é‡ï¼Œè€Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„å…±äº«é”®å€¼å­˜å‚¨ã€‚</p> <h3 id="æ¸…ç†çŠ¶æ€"><a href="#æ¸…ç†çŠ¶æ€" class="header-anchor">#</a> æ¸…ç†çŠ¶æ€</h3> <p>ä¸Šé¢ä¾‹å­æœ‰ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼šå½“é”®ç©ºé—´æ˜¯æ— ç•Œçš„æ—¶å€™å°†å‘ç”Ÿä»€ä¹ˆï¼ŸFlink ä¼šå¯¹æ¯ä¸ªä½¿ç”¨è¿‡çš„é”®éƒ½å­˜å‚¨ä¸€ä¸ª <code>Boolean</code> ç±»å‹çš„å®ä¾‹ã€‚å¦‚æœæ˜¯é”®æ˜¯æœ‰é™çš„é›†åˆè¿˜å¥½ï¼Œä½†åœ¨é”®æ— é™å¢é•¿çš„åº”ç”¨ä¸­ï¼Œæ¸…é™¤å†ä¹Ÿä¸ä¼šä½¿ç”¨çš„çŠ¶æ€æ˜¯å¾ˆå¿…è¦çš„ã€‚è¿™é€šè¿‡åœ¨çŠ¶æ€å¯¹è±¡ä¸Šè°ƒç”¨ <code>clear()</code> æ¥å®ç°ï¼Œå¦‚ä¸‹ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code>keyHasBeenSeen<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>å¯¹ä¸€ä¸ªç»™å®šçš„é”®å€¼ï¼Œä½ ä¹Ÿè®¸æƒ³åœ¨å®ƒä¸€æ®µæ—¶é—´ä¸ä½¿ç”¨åæ¥åšè¿™ä»¶äº‹ã€‚å½“å­¦ä¹  <code>ProcessFunction</code> çš„ç›¸å…³ç« èŠ‚æ—¶ï¼Œä½ å°†çœ‹åˆ°åœ¨äº‹ä»¶é©±åŠ¨çš„åº”ç”¨ä¸­æ€ä¹ˆç”¨å®šæ—¶å™¨æ¥åšè¿™ä¸ªã€‚</p> <p>ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨ <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/dev/datastream/fault-tolerance/state/#state-time-to-live-ttl" target="_blank" rel="noopener noreferrer">çŠ¶æ€çš„è¿‡æœŸæ—¶é—´ï¼ˆTTLï¼‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œä¸ºçŠ¶æ€æè¿°ç¬¦é…ç½®ä½ æƒ³è¦æ—§çŠ¶æ€è‡ªåŠ¨è¢«æ¸…é™¤çš„æ—¶é—´ã€‚</p> <h3 id="non-keyed-state"><a href="#non-keyed-state" class="header-anchor">#</a> Non-keyed State</h3> <p>åœ¨æ²¡æœ‰é”®çš„ä¸Šä¸‹æ–‡ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Flink ç®¡ç†çš„çŠ¶æ€ã€‚è¿™ä¹Ÿè¢«ç§°ä½œ <a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/docs/dev/datastream/fault-tolerance/state/#operator-state" target="_blank" rel="noopener noreferrer">ç®—å­çš„çŠ¶æ€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚å®ƒåŒ…å«çš„æ¥å£æ˜¯å¾ˆä¸ä¸€æ ·çš„ï¼Œç”±äºå¯¹ç”¨æˆ·å®šä¹‰çš„å‡½æ•°æ¥è¯´ä½¿ç”¨ non-keyed state æ˜¯ä¸å¤ªå¸¸è§çš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å¤šä»‹ç»äº†ã€‚è¿™ä¸ªç‰¹æ€§æœ€å¸¸ç”¨äº source å’Œ sink çš„å®ç°ã€‚</p> <h2 id="connected-streams"><a href="#connected-streams" class="header-anchor">#</a> Connected Streams</h2> <p>ç›¸æ¯”äºä¸‹é¢è¿™ç§é¢„å…ˆå®šä¹‰çš„è½¬æ¢ï¼š</p> <p><img src="https://nightlies.apache.org/flink/flink-docs-release-1.14/fig/transformation.svg" alt="simple transformation"></p> <p>æœ‰æ—¶ä½ æƒ³è¦æ›´çµæ´»åœ°è°ƒæ•´è½¬æ¢çš„æŸäº›åŠŸèƒ½ï¼Œæ¯”å¦‚æ•°æ®æµçš„é˜ˆå€¼ã€è§„åˆ™æˆ–è€…å…¶ä»–å‚æ•°ã€‚Flink æ”¯æŒè¿™ç§éœ€æ±‚çš„æ¨¡å¼ç§°ä¸º <em>connected streams</em> ï¼Œä¸€ä¸ªå•ç‹¬çš„ç®—å­æœ‰ä¸¤ä¸ªè¾“å…¥æµã€‚</p> <p><img src="https://nightlies.apache.org/flink/flink-docs-release-1.14/fig/connected-streams.svg" alt="connected streams"></p> <p>connected stream ä¹Ÿå¯ä»¥è¢«ç”¨æ¥å®ç°æµçš„å…³è”ã€‚</p> <h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="header-anchor">#</a> ç¤ºä¾‹</h3> <p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸€ä¸ªæ§åˆ¶æµæ˜¯ç”¨æ¥æŒ‡å®šå“ªäº›è¯éœ€è¦ä» <code>streamOfWords</code> é‡Œè¿‡æ»¤æ‰çš„ã€‚ ä¸€ä¸ªç§°ä¸º <code>ControlFunction</code> çš„ <code>RichCoFlatMapFunction</code> ä½œç”¨äºè¿æ¥çš„æµæ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">StreamExecutionEnvironment</span> env <span class="token operator">=</span> <span class="token class-name">StreamExecutionEnvironment</span><span class="token punctuation">.</span><span class="token function">getExecutionEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> control <span class="token operator">=</span> env
        <span class="token punctuation">.</span><span class="token function">fromElements</span><span class="token punctuation">(</span><span class="token string">&quot;DROP&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;IGNORE&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">DataStream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> streamOfWords <span class="token operator">=</span> env
        <span class="token punctuation">.</span><span class="token function">fromElements</span><span class="token punctuation">(</span><span class="token string">&quot;Apache&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DROP&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Flink&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;IGNORE&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">keyBy</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>

    control
        <span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>streamOfWords<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ControlFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    env<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œæ³¨æ„ä¸¤ä¸ªæµåªæœ‰é”®ä¸€è‡´çš„æ—¶å€™æ‰èƒ½è¿æ¥ã€‚ <code>keyBy</code> çš„ä½œç”¨æ˜¯å°†æµæ•°æ®åˆ†åŒºï¼Œå½“ keyed stream è¢«è¿æ¥æ—¶ï¼Œä»–ä»¬å¿…é¡»æŒ‰ç›¸åŒçš„æ–¹å¼åˆ†åŒºã€‚è¿™æ ·ä¿è¯äº†ä¸¤ä¸ªæµä¸­æ‰€æœ‰é”®ç›¸åŒçš„äº‹ä»¶å‘åˆ°åŒä¸€ä¸ªå®ä¾‹ä¸Šã€‚è¿™æ ·ä¹Ÿä½¿æŒ‰é”®å…³è”ä¸¤ä¸ªæµæˆä¸ºå¯èƒ½ã€‚</p> <p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸¤ä¸ªæµéƒ½æ˜¯ <code>DataStream&lt;String&gt;</code> ç±»å‹çš„ï¼Œå¹¶ä¸”éƒ½å°†å­—ç¬¦ä¸²ä½œä¸ºé”®ã€‚æ­£å¦‚ä½ å°†åœ¨ä¸‹é¢çœ‹åˆ°çš„ï¼Œ<code>RichCoFlatMapFunction</code> åœ¨çŠ¶æ€ä¸­å­˜äº†ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å˜é‡ï¼Œè¿™ä¸ªå˜é‡è¢«ä¸¤ä¸ªæµå…±äº«ã€‚</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ControlFunction</span> <span class="token keyword">extends</span> <span class="token class-name">RichCoFlatMapFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">ValueState</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> blocked<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token keyword">open</span><span class="token punctuation">(</span><span class="token class-name">Configuration</span> config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        blocked <span class="token operator">=</span> <span class="token function">getRuntimeContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValueStateDescriptor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;blocked&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">flatMap1</span><span class="token punctuation">(</span><span class="token class-name">String</span> control_value<span class="token punctuation">,</span> <span class="token class-name">Collector</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        blocked<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Boolean</span><span class="token punctuation">.</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">flatMap2</span><span class="token punctuation">(</span><span class="token class-name">String</span> data_value<span class="token punctuation">,</span> <span class="token class-name">Collector</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>blocked<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            out<span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span>data_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>RichCoFlatMapFunction</code> æ˜¯ä¸€ç§å¯ä»¥è¢«ç”¨äºä¸€å¯¹è¿æ¥æµçš„ <code>FlatMapFunction</code>ï¼Œå¹¶ä¸”å®ƒå¯ä»¥è°ƒç”¨ rich function çš„æ¥å£ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥æ˜¯æœ‰çŠ¶æ€çš„ã€‚</p> <p>å¸ƒå°”å˜é‡ <code>blocked</code> è¢«ç”¨äºè®°å½•åœ¨æ•°æ®æµ <code>control</code> ä¸­å‡ºç°è¿‡çš„é”®ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯å•è¯ï¼‰ï¼Œå¹¶ä¸”è¿™äº›å•è¯ä» <code>streamOfWords</code> è¿‡æ»¤æ‰ã€‚è¿™æ˜¯ <em>keyed</em> stateï¼Œå¹¶ä¸”å®ƒæ˜¯è¢«ä¸¤ä¸ªæµå…±äº«çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸¤ä¸ªæµå¿…é¡»æœ‰ç›¸åŒçš„é”®å€¼ç©ºé—´ã€‚</p> <p>åœ¨ Flink è¿è¡Œæ—¶ä¸­ï¼Œ<code>flatMap1</code> å’Œ <code>flatMap2</code> åœ¨è¿æ¥æµæœ‰æ–°å…ƒç´ åˆ°æ¥æ—¶è¢«è°ƒç”¨ â€”â€” åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ<code>control</code> æµä¸­çš„å…ƒç´ ä¼šè¿›å…¥ <code>flatMap1</code>ï¼Œ<code>streamOfWords</code> ä¸­çš„å…ƒç´ ä¼šè¿›å…¥ <code>flatMap2</code>ã€‚è¿™æ˜¯ç”±ä¸¤ä¸ªæµè¿æ¥çš„é¡ºåºå†³å®šçš„ï¼Œæœ¬ä¾‹ä¸­ä¸º <code>control.connect(streamOfWords)</code>ã€‚</p> <p>è®¤è¯†åˆ°ä½ æ²¡æ³•æ§åˆ¶ <code>flatMap1</code> å’Œ <code>flatMap2</code> çš„è°ƒç”¨é¡ºåºæ˜¯å¾ˆé‡è¦çš„ã€‚è¿™ä¸¤ä¸ªè¾“å…¥æµæ˜¯ç›¸äº’ç«äº‰çš„å…³ç³»ï¼ŒFlink è¿è¡Œæ—¶å°†æ ¹æ®ä»ä¸€ä¸ªæµæˆ–å¦ä¸€ä¸ªæµä¸­æ¶ˆè´¹çš„äº‹ä»¶åšå®ƒè¦åšçš„ã€‚å¯¹äºéœ€è¦ä¿è¯æ—¶é—´å’Œ/æˆ–é¡ºåºçš„åœºæ™¯ï¼Œä½ ä¼šå‘ç°åœ¨ Flink çš„ç®¡ç†çŠ¶æ€ä¸­ç¼“å­˜äº‹ä»¶ä¸€ç›´åˆ°å®ƒä»¬èƒ½å¤Ÿè¢«å¤„ç†æ˜¯å¿…é¡»çš„ã€‚ï¼ˆæ³¨æ„ï¼šå¦‚æœä½ çœŸçš„æ„Ÿåˆ°ç»æœ›ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ç®—å­å®ç° <code>InputSelectable</code> æ¥å£ï¼Œåœ¨ä¸¤è¾“å…¥ç®—å­æ¶ˆè´¹å®ƒçš„è¾“å…¥æµæ—¶å¢åŠ ä¸€äº›é¡ºåºä¸Šçš„é™åˆ¶ã€‚ï¼‰</p> <h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="header-anchor">#</a> å‚è€ƒèµ„æ–™</h2> <ul><li><a href="https://nightlies.apache.org/flink/flink-docs-release-1.14/zh/" target="_blank" rel="noopener noreferrer">Flink å®˜æ–¹æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/bigdata-tutorial/edit/master/docs/flink/FlinkETL.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æˆ‘ä»¬æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">4 days ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/bigdata-tutorial/assets/js/app.3ada26ba.js" defer></script><script src="/bigdata-tutorial/assets/js/4.cda5e0f1.js" defer></script><script src="/bigdata-tutorial/assets/js/13.1b26207d.js" defer></script><script src="/bigdata-tutorial/assets/js/5.9d6e4fe2.js" defer></script>
  </body>
</html>
